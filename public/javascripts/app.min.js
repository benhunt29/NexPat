var app=angular.module("NextPat",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$httpProvider","$routeProvider","$locationProvider","$mdThemingProvider",function(e,t,n,o){n.html5Mode(!0),e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"],e.interceptors.push("authInterceptor"),o.theme("default").primaryPalette("blue-grey").accentPalette("grey").warnPalette("red").backgroundPalette("blue-grey"),t.when("/",{templateUrl:"/views/home.html",controller:"homeController"}).when("/about",{templateUrl:"/views/about.html",controller:"aboutController"}).when("/contact",{templateUrl:"/views/contact.html",controller:"contactController"}).when("/login",{templateUrl:"/views/login.html",controller:"loginController"}).when("/signUp",{templateUrl:"/views/signUp.html",controller:"signUpController"}).when("/questionnaire",{templateUrl:"/views/questionnaire.html",controller:"questionnaireController"}).when("/help",{templateUrl:"/views/help.html",controller:"helpController"}).when("/country",{templateUrl:"/views/country.html",controller:"countryController"}).otherwise({redirectTo:"/"})}]),app.controller("homeController",["authService","countryPage","questionnaire","userRecommendations","$http","$rootScope","$scope","$location",function(e,t,n,o,a,r,i,s){if(r.user=e.getUser(),r.user&&r.user.username)i.recommendations||(o.countries?i.recommendations=o.countries:a.get("/api/questionnaire/"+r.user.username).then(function(e){console.log(r.user.username),"object"==typeof e.data?a.post("/api/worldFactbook",{languageOption:!0,language:e.data.question1}).then(function(t){console.log(e,t),i.recommendations=n.determineRecommendations(e.data,t.data),o.countries=i.recommendations}):s.path("/questionnaire")}));else{var u=[{question:"Have you been here before?",route:"login"},{question:"Would you like to sign up?",route:"signUp"},{question:"Okay, you won't be able to do much..."}];i.question=u[0].question;var l=0;i.showButtons=!0,i.getQuestion=function(e){var t=(u[l].question,u[l].route);e?s.path(t):(l++,i.question=u[l].question,l==u.length-1&&(i.showButtons=!1))}}i.setCountryPage=function(e,n){t.name=e,t.abbreviation=n,s.path("/country")}}]),app.controller("aboutController",["$scope",function(e){}]),app.controller("contactController",["$scope",function(e){e.message="I'm a page that tells you how to yell (by writing an all-caps email) at the developer!"}]),app.controller("signUpController",["$location","$scope","$http",function(e,t,n){t.register=function(){var o={username:t.form.userName,email:t.form.email,password:t.form.password,lastName:t.form.lastName,firstName:t.form.firstName,passwordConfirm:t.form.passwordConfirm};n.post("/api/register",o).then(function(t){console.log(t),e.path("/login")})}}]),app.controller("countryController",["countryPage","$scope","$http",function(e,t,n){t.countryName=e.name,t.abbreviation=e.abbreviation,n.get("/worldBank/worldBankData/"+t.abbreviation).then(function(e){console.log(e)})}]),app.controller("loginController",["$scope","$http","authService","$location","$rootScope",function(e,t,n,o,a){e.signIn=function(){var r={username:e.form.userName,password:e.form.password};t.post("api/login",r).then(function(e){n.saveToken(e.data),a.user=n.getUser(),o.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,n,o,a){n.user=e.getUser(),n.user&&n.user.username&&o.path("/"),t.logout=function(){a.get("/api/questionnaire/"+n.user.username),a.get("/api/logout").then(function(e){console.log(e)}),e.logout(),n.user=e.getUser(),o.path("/home")}}]),app.controller("helpController",["$scope",function(e){e.message="I'm a help page that currently doesn't help at all"}]),app.controller("questionnaireController",["countryPage","userRecommendations","questionnaire","$rootScope","$scope","$location","$http","$log","$q",function(e,t,n,o,a,r,i,s,u){function l(){return a.list.map(function(e){return{value:e.toLowerCase(),display:e}})}function c(e){var t=angular.lowercase(e);return function(e){return 0===e.value.indexOf(t)}}o.user.username||r.path("/login");var p=n.questions,h={},m={};a.questionNum=0,a.data={},a.data={},a.answers=[],a.querySearch=function(e){return e?a.list.filter(c(e)):a.list},a.pushAnswer=function(e){e&&(a.answers.push(e),a.data.showAnswers=!0)},i.get("/api/questionnaire/"+o.user.username).then(function(e){console.log(o.user.username),"object"==typeof e.data?i.post("/api/worldFactbook",{languageOption:!0,language:e.data.question1}).then(function(o){console.log(e,o),a.recommendations=n.determineRecommendations(e.data,o.data),t.countries=a.recommendations}):(a.getQuestion(),a.list=l())}),a.getQuestion=function(){a.data.showAnswers=!1,a.questionNum==p.length?(a.question="Your list is being generated!",m.username=o.user.username,m.questionResponses=h,i.post("/api/questionnaire",m),i.post("/api/worldFactbook",{languageOption:!0,language:h.question1}).then(function(e){a.recommendations=n.determineRecommendations(h,e.data),t.countries=a.recommendations,r.path("/")}),a.type=""):(a.question=p[a.questionNum].question,a.type=p[a.questionNum].type,console.log(a.question,a.type),"list"==a.type&&(a.list=p[a.questionNum].answerOptions))},a.logAnswer=function(e){a.data.showAnswers=!1,a.questionNum++,e.constructor===Array&&(e=e.join(" ")),h["question"+a.questionNum]=e,a.answers=[],a.searchText=""},a.addCountry=function(){i.post("/api/userCountries",{username:o.user.username,userCountries:["france","germany","spain"]}).then(function(e){a.userCountries=e.userCountries})},a.setCountryPage=function(t){e.name=t},a.deleteQuestionnaire=function(){i["delete"]("api/questionnaire/"+o.user.username).then(function(e){console.log("deleted!"),t={},a.recommendations=!1,a.questionNum=0,a.getQuestion(),a.list=l()})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var n=t.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(e.atob(o))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),n=Math.round((new Date).getTime()/1e3)<=t.exp;return n||this.logout(),n}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},console.log(e.url),n.isAuthed()&&(e.headers.Authorization="Bearer "+n.getToken()),e},response:function(o){return t.search().access_token&&(n.saveToken(t.search().access_token),t.search("access_token",void 0),t.path("/")),401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(n){return 401===n.status?t.path("/login"):console.log(n),e.reject(n)}}}]),app.factory("questionnaire",function(){return{questions:[{question:"What language(s) do you speak?",type:"list",answerOptions:["Adyghe","Albanian","Aragonese","Armenian","Aromanian","Arpitan","Asturian","Avar","Azerbaijani","Bashkir","Basque","Belarusian","Bosnian","Breton","Bulgarian","Catalan","Chechen","Chuvash","Cornish","Corsican","Crimean","Croatian","Czech","Danish","Dutch","English","Erzya","Estonian","Faroese","Finnish","French","Frisian","Gagauz","Galician","Gallo","Georgian","German","Greek","Hungarian","Icelandic","Ingrian","Irish","Italian","Kabardian","Kashubian","Kazakh","Ladin","Latin","Latvian","Laz","Lithuanian","Luxembourgish","Macedonian","Maltese","Manx","Mari","Mingrelian","Mirandese","Montenegrin","Norwegian","Occitan","Ossetian","Picard","Polish","Portuguese","Romani","Romanian","Romansh","Russian","Sami","Sardinian","Scots","Scottish","Gaelic","Serbian","Silesian","Slovak","Slovene","Sorbian","Spanish","Svan","Swedish","Tabasaran","Tatar","Turkish","Ukrainian","Vepsian","VÃµro","Walloon","Welsh","Wymysorys"]},{question:"What field do you work in?",type:"list",answerOptions:["Agriculture","Industry","Services"]},{question:"What climate(s) would you prefer?",type:"list",answerOptions:["Temperate","Mediterranean","Tropical","Arid","Desert","Maritime","Wet"]},{question:"What is the ideal size for the largest metropolitan area?",type:"list",answerOptions:["Small (<100,000)","Medium (100,000-1 million)","Large (>1 million)"]},{question:"Would you like the population distribution to be mostly urban?",type:"boolean"},{question:"What would your ideal median age range be?",type:"list",answerOptions:["20-30yrs","30-40yrs","40+years"]},{question:"What cost of living should your destination have?",type:"list",answerOptions:["High","Average","Low"]},{question:"What percentage of the population should be internet users?",type:"list",answerOptions:["<25%","25%-50%","50%-75%",">75%"]}],determineRecommendations:function(e,t){function n(e,t,n){if(n>=e&&t>=n)return 10;var o=Math.abs(n-e)>Math.abs(n-t)?t:e,a=n>o?.5:1.5,r=20*(1-Math.min(1,Math.abs(n-a*o)/o));return r}return countries=[],t.forEach(function(t,o){var a,r,i,s=0,u=t.labor[e.question2]||0,l=u/7.5>10?10:u/10;i="array"==typeof e.question3?new RegExp(e.question3.join("|"),"i"):new RegExp(e.question3,"i");var c=null!=t.climate.match(i)?10:0,p=e.question4;switch(p){case"Small (<100,000)":r=0,a=1e5;break;case"Medium (100,000-1 million)":r=1e5,a=1e6;break;case"Large (>1 million)":r=1e6,a=1e20}var h,m=n(r,a,t.largestCityPop)||0,g=e.question5;h=g?t.urbanPopulation>50?10:10*t.urbanPopulation/50:t.urbanPopulation<50?10:500/t.urbanPopulation;var d=e.question6;switch(d){case"20-30yrs":r=0,a=30;break;case"30-40yrs":r=30,a=40;break;case"40+years":r=40,a=150}var f=n(r,a,t.medianAge),w=e.question7;switch(w){case"High":r=6e4,a=1e10;break;case"Average":r=3e4,a=6e4;break;case"Low":r=0,a=3e4}var y=n(r,a,t.perCapitaPPP),q=e.question8;switch(q){case"<25%":r=0,a=25;break;case"25%-50%":r=25,a=50;break;case"50%-75%":r=50,a=75;break;default:r=75,a=100}var v=n(r,a,t.internetUsagePerCapita);s=s+l+c+m+h+y+f+v,t.score=s,countries.push(t)}),countries.sort(function(e,t){return e.score>t.score?-1:e.score<t.score?1:e.countryName>t.countryName?1:e.countryName<t.countryName?-1:0}),countries.slice(0,4)}}}),app.factory("countryPage",function(){return{}}),app.factory("userRecommendations",function(){return{}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJkZWZhdWx0cyIsInVzZVhEb21haW4iLCJoZWFkZXJzIiwiY29tbW9uIiwiaW50ZXJjZXB0b3JzIiwicHVzaCIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwid2FyblBhbGV0dGUiLCJiYWNrZ3JvdW5kUGFsZXR0ZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiYXV0aFNlcnZpY2UiLCJjb3VudHJ5UGFnZSIsInF1ZXN0aW9ubmFpcmUiLCJ1c2VyUmVjb21tZW5kYXRpb25zIiwiJGh0dHAiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJGxvY2F0aW9uIiwidXNlciIsImdldFVzZXIiLCJ1c2VybmFtZSIsInJlY29tbWVuZGF0aW9ucyIsImNvdW50cmllcyIsImdldCIsInRoZW4iLCJ1c2VyQW5zd2VycyIsImNvbnNvbGUiLCJsb2ciLCJkYXRhIiwicG9zdCIsImxhbmd1YWdlT3B0aW9uIiwibGFuZ3VhZ2UiLCJxdWVzdGlvbjEiLCJjb3VudHJpZXNUb1NlYXJjaCIsImRldGVybWluZVJlY29tbWVuZGF0aW9ucyIsInBhdGgiLCJpbnRyb1F1ZXN0aW9ucyIsInF1ZXN0aW9uIiwicm91dGUiLCJxdWVzdGlvbk51bSIsInNob3dCdXR0b25zIiwiZ2V0UXVlc3Rpb24iLCJhbnN3ZXIiLCJsZW5ndGgiLCJzZXRDb3VudHJ5UGFnZSIsImNvdW50cnlOYW1lIiwiYWJicmV2aWF0aW9uIiwibmFtZSIsIm1lc3NhZ2UiLCJyZWdpc3RlciIsIm5ld1VzZXIiLCJmb3JtIiwidXNlck5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwibGFzdE5hbWUiLCJmaXJzdE5hbWUiLCJwYXNzd29yZENvbmZpcm0iLCJyZXNwb25zZSIsInNpZ25JbiIsInNhdmVUb2tlbiIsImxvZ291dCIsIiRsb2ciLCIkcSIsImxvYWRBbGwiLCJsaXN0IiwibWFwIiwiaXRlbSIsInZhbHVlIiwidG9Mb3dlckNhc2UiLCJkaXNwbGF5IiwiY3JlYXRlRmlsdGVyRm9yIiwicXVlcnkiLCJsb3dlcmNhc2VRdWVyeSIsImxvd2VyY2FzZSIsImluZGV4T2YiLCJxdWVzdGlvbnMiLCJxdWVzdGlvblJlc3BvbnNlcyIsInVzZXJRdWVzdGlvbm5haXJlIiwiYW5zd2VycyIsInF1ZXJ5U2VhcmNoIiwiZmlsdGVyIiwicHVzaEFuc3dlciIsInNob3dBbnN3ZXJzIiwidHlwZSIsImFuc3dlck9wdGlvbnMiLCJsb2dBbnN3ZXIiLCJjb25zdHJ1Y3RvciIsIkFycmF5Iiwiam9pbiIsInNlYXJjaFRleHQiLCJhZGRDb3VudHJ5IiwidXNlckNvdW50cmllcyIsImRlbGV0ZVF1ZXN0aW9ubmFpcmUiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiZ2V0VG9rZW4iLCJpc0F1dGhlZCIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJNYXRoIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImZhY3RvcnkiLCJyZXF1ZXN0IiwidXJsIiwiQXV0aG9yaXphdGlvbiIsInNlYXJjaCIsImFjY2Vzc190b2tlbiIsInVuZGVmaW5lZCIsInN0YXR1cyIsInJlc3BvbnNlRXJyb3IiLCJyZWplY3QiLCJxdWVzdGlvbm5haXJlQW5zd2VycyIsImdldFByb3BvcnRpb25hbFNjb3JlIiwibG93ZXJMaW1pdCIsInVwcGVyTGltaXQiLCJsaW1pdCIsImFicyIsIm11bHRpcGxpZXIiLCJzY29yZSIsIm1pbiIsImZvckVhY2giLCJjb3VudHJ5IiwiaW5kZXgiLCJjbGltYXRlU3RyaW5nIiwibGFib3JQZXJjZW50IiwibGFib3IiLCJxdWVzdGlvbjIiLCJsYWJvclNjb3JlIiwicXVlc3Rpb24zIiwiUmVnRXhwIiwiY2xpbWF0ZVNjb3JlIiwiY2xpbWF0ZSIsIm1hdGNoIiwidXNlckxhcmdlc3RDaXR5UG9wIiwicXVlc3Rpb240IiwidXJiYW5Qb3B1bGF0aW9uU2NvcmUiLCJsYXJnZXN0Q2l0eVBvcFNjb3JlIiwibGFyZ2VzdENpdHlQb3AiLCJ1c2VyVXJiYW5Qb3B1bGF0aW9uIiwicXVlc3Rpb241IiwidXJiYW5Qb3B1bGF0aW9uIiwidXNlck1lZGlhbkFnZSIsInF1ZXN0aW9uNiIsIm1lZGlhbkFnZVNjb3JlIiwibWVkaWFuQWdlIiwidXNlclBlckNhcGl0YVBQUCIsInF1ZXN0aW9uNyIsInBlckNhcGl0YVBQUFNjb3JlIiwicGVyQ2FwaXRhUFBQIiwidXNlckludGVybmV0VXNhZ2VQZXJDYXBpdGEiLCJxdWVzdGlvbjgiLCJpbnRlcm5ldFVzYWdlU2NvcmUiLCJpbnRlcm5ldFVzYWdlUGVyQ2FwaXRhIiwic29ydCIsImEiLCJiIiwic2xpY2UiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsV0FBQSxVQUFBLGFBQUEsYUFBQSxvQkFFQUYsS0FBQUcsUUFBQSxnQkFBQSxpQkFBQSxvQkFBQSxxQkFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUVBRCxFQUFBRSxXQUFBLEdBRUFKLEVBQUFLLFNBQUFDLFlBQUEsUUFDQU4sR0FBQUssU0FBQUUsUUFBQUMsT0FBQSxvQkFFQVIsRUFBQVMsYUFBQUMsS0FBQSxtQkFFQVAsRUFDQVEsTUFBQSxXQUNBQyxlQUFBLGFBQ0FDLGNBQUEsUUFDQUMsWUFBQSxPQUNBQyxrQkFBQSxhQUVBZCxFQUFBZSxLQUFBLEtBRUFDLFlBQUEsbUJBQ0FDLFdBQUEsbUJBQ0FGLEtBQUEsVUFFQUMsWUFBQSxvQkFDQUMsV0FBQSxvQkFDQUYsS0FBQSxZQUVBQyxZ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SSxJQUFBb0ksUUFBQSxzQkFBQSxXQUNBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ05leHRQYXQnLCBbJ25nUm91dGUnLCduZ01hdGVyaWFsJywnbmdNZXNzYWdlcycsJ3ZhbGlkYXRpb24ubWF0Y2gnXSk7XG5cbmFwcC5jb25maWcoWyckaHR0cFByb3ZpZGVyJywnJHJvdXRlUHJvdmlkZXInLCckbG9jYXRpb25Qcm92aWRlcicsJyRtZFRoZW1pbmdQcm92aWRlcicsIGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIsJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCRtZFRoZW1pbmdQcm92aWRlcil7XG5cbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLnVzZVhEb21haW4gPSB0cnVlO1xuICAgIGRlbGV0ZSAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLVJlcXVlc3RlZC1XaXRoJ107XG5cbiAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdhdXRoSW50ZXJjZXB0b3InKTtcblxuICAgICRtZFRoZW1pbmdQcm92aWRlclxuICAgICAgICAudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2JsdWUtZ3JleScpXG4gICAgICAgIC5hY2NlbnRQYWxldHRlKCdncmV5JylcbiAgICAgICAgLndhcm5QYWxldHRlKCdyZWQnKVxuICAgICAgICAuYmFja2dyb3VuZFBhbGV0dGUoJ2JsdWUtZ3JleScpO1xuXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9hYm91dCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Fib3V0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Fib3V0Q29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL2NvbnRhY3QnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jb250YWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NvbnRhY3RDb250cm9sbGVyJ1xuICAgICAgICB9KS53aGVuKCcvbG9naW4nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9zaWduVXAnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zaWduVXAuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnc2lnblVwQ29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL3F1ZXN0aW9ubmFpcmUnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9xdWVzdGlvbm5haXJlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3F1ZXN0aW9ubmFpcmVDb250cm9sbGVyJ1xuICAgICAgICB9KS53aGVuKCcvaGVscCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2hlbHAuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnaGVscENvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9jb3VudHJ5JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY291bnRyeS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb3VudHJ5Q29udHJvbGxlcidcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgfSk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdob21lQ29udHJvbGxlcicsIFsnYXV0aFNlcnZpY2UnLCdjb3VudHJ5UGFnZScsJ3F1ZXN0aW9ubmFpcmUnLCd1c2VyUmVjb21tZW5kYXRpb25zJywnJGh0dHAnLCckcm9vdFNjb3BlJywnJHNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsY291bnRyeVBhZ2UscXVlc3Rpb25uYWlyZSx1c2VyUmVjb21tZW5kYXRpb25zLCRodHRwLCRyb290U2NvcGUsJHNjb3BlLCRsb2NhdGlvbil7XG5cbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgaWYoISRzY29wZS5yZWNvbW1lbmRhdGlvbnMpe1xuICAgICAgICAgICAgaWYgKHVzZXJSZWNvbW1lbmRhdGlvbnMuY291bnRyaWVzKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVjb21tZW5kYXRpb25zID0gdXNlclJlY29tbWVuZGF0aW9ucy5jb3VudHJpZXM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9xdWVzdGlvbm5haXJlLycrJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKS5cbiAgICAgICAgICAgICAgICAgICAgdGhlbihmdW5jdGlvbih1c2VyQW5zd2Vycyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIHVzZXJBbnN3ZXJzLmRhdGEgPT0gJ29iamVjdCcpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvd29ybGRGYWN0Ym9vaycse2xhbmd1YWdlT3B0aW9uOnRydWUsbGFuZ3VhZ2U6dXNlckFuc3dlcnMuZGF0YS5xdWVzdGlvbjF9KS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbihmdW5jdGlvbihjb3VudHJpZXNUb1NlYXJjaCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyQW5zd2Vycyxjb3VudHJpZXNUb1NlYXJjaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVjb21tZW5kYXRpb25zID0gcXVlc3Rpb25uYWlyZS5kZXRlcm1pbmVSZWNvbW1lbmRhdGlvbnModXNlckFuc3dlcnMuZGF0YSxjb3VudHJpZXNUb1NlYXJjaC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJSZWNvbW1lbmRhdGlvbnMuY291bnRyaWVzID0gJHNjb3BlLnJlY29tbWVuZGF0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9xdWVzdGlvbm5haXJlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNle1xuICAgICAgICAgICAgdmFyIGludHJvUXVlc3Rpb25zID0gW3txdWVzdGlvbjogXCJIYXZlIHlvdSBiZWVuIGhlcmUgYmVmb3JlP1wiLCByb3V0ZTonbG9naW4nfSxcbiAgICAgICAgICAgICAgICB7cXVlc3Rpb246IFwiV291bGQgeW91IGxpa2UgdG8gc2lnbiB1cD9cIiwgcm91dGU6ICdzaWduVXAnfSxcbiAgICAgICAgICAgICAgICB7cXVlc3Rpb246IFwiT2theSwgeW91IHdvbid0IGJlIGFibGUgdG8gZG8gbXVjaC4uLlwifV07XG4gICAgICAgICAgICAkc2NvcGUucXVlc3Rpb24gPSBpbnRyb1F1ZXN0aW9uc1swXS5xdWVzdGlvbjtcbiAgICAgICAgICAgIHZhciBxdWVzdGlvbk51bSA9IDA7XG4gICAgICAgICAgICAkc2NvcGUuc2hvd0J1dHRvbnMgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLmdldFF1ZXN0aW9uID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1ZXN0aW9uVGV4dCA9IGludHJvUXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS5xdWVzdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgcm91dGUgPSBpbnRyb1F1ZXN0aW9uc1txdWVzdGlvbk51bV0ucm91dGU7XG4gICAgICAgICAgICAgICAgaWYgKGFuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChyb3V0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNle1xuICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbk51bSsrO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucXVlc3Rpb24gPSBpbnRyb1F1ZXN0aW9uc1txdWVzdGlvbk51bV0ucXVlc3Rpb247XG4gICAgICAgICAgICAgICAgICAgIGlmKHF1ZXN0aW9uTnVtID09IGludHJvUXVlc3Rpb25zLmxlbmd0aC0xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QnV0dG9ucyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgJHNjb3BlLnNldENvdW50cnlQYWdlID0gZnVuY3Rpb24oY291bnRyeU5hbWUsYWJicmV2aWF0aW9uKXtcblxuICAgICAgICBjb3VudHJ5UGFnZS5uYW1lID0gY291bnRyeU5hbWU7XG4gICAgICAgIGNvdW50cnlQYWdlLmFiYnJldmlhdGlvbiA9IGFiYnJldmlhdGlvbjtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9jb3VudHJ5Jyk7XG4gICAgfTtcblxufV0pO1xuXG5hcHAuY29udHJvbGxlcignYWJvdXRDb250cm9sbGVyJywgWyckc2NvcGUnLGZ1bmN0aW9uKCRzY29wZSl7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdjb250YWN0Q29udHJvbGxlcicsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBwYWdlIHRoYXQgdGVsbHMgeW91IGhvdyB0byB5ZWxsIChieSB3cml0aW5nIGFuIGFsbC1jYXBzIGVtYWlsKSBhdCB0aGUgZGV2ZWxvcGVyIVwiO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignc2lnblVwQ29udHJvbGxlcicsWyckbG9jYXRpb24nLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKCRsb2NhdGlvbiwkc2NvcGUsJGh0dHApe1xuICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgdmFyIG5ld1VzZXIgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogJHNjb3BlLmZvcm0udXNlck5hbWUsXG4gICAgICAgICAgICBlbWFpbDogJHNjb3BlLmZvcm0uZW1haWwsXG4gICAgICAgICAgICBwYXNzd29yZDogJHNjb3BlLmZvcm0ucGFzc3dvcmQsXG4gICAgICAgICAgICBsYXN0TmFtZTogJHNjb3BlLmZvcm0ubGFzdE5hbWUsXG4gICAgICAgICAgICBmaXJzdE5hbWU6ICRzY29wZS5mb3JtLmZpcnN0TmFtZSxcbiAgICAgICAgICAgIHBhc3N3b3JkQ29uZmlybTogJHNjb3BlLmZvcm0ucGFzc3dvcmRDb25maXJtXG4gICAgICAgIH07XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvcmVnaXN0ZXInLG5ld1VzZXIpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufV0pO1xuXG5hcHAuY29udHJvbGxlcignY291bnRyeUNvbnRyb2xsZXInLCBbJ2NvdW50cnlQYWdlJywnJHNjb3BlJywnJGh0dHAnLCBmdW5jdGlvbihjb3VudHJ5UGFnZSwkc2NvcGUsJGh0dHApe1xuICAgICRzY29wZS5jb3VudHJ5TmFtZSA9IGNvdW50cnlQYWdlLm5hbWU7XG4gICAgJHNjb3BlLmFiYnJldmlhdGlvbiA9IGNvdW50cnlQYWdlLmFiYnJldmlhdGlvbjtcblxuICAgICRodHRwLmdldCgnL3dvcmxkQmFuay93b3JsZEJhbmtEYXRhLycrJHNjb3BlLmFiYnJldmlhdGlvbilcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICB9KTtcblxuICAgIC8vdmFyIGNvbWJpbmVkSW5kaWNhdG9ycyA9ICcnO1xuICAgIC8vd29ybGRCYW5rSW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0saW5kZXgpe1xuICAgIC8vICAgICAgICBjb21iaW5lZEluZGljYXRvcnMgKz0gaXRlbS5pbmRpY2F0b3JDb2RlICsnOyc7XG4gICAgLy8gICAgfSk7XG4gICAgLy9cbiAgICAvL2NvbWJpbmVkSW5kaWNhdG9ycyA9IGNvbWJpbmVkSW5kaWNhdG9ycy5zdWJzdHJpbmcoMCxjb21iaW5lZEluZGljYXRvcnMubGVuZ3RoLTEpO1xuICAgIC8vXG4gICAgLy92YXIgd29ybGRCYW5rQVBJUXVlcnkxID0gJ2h0dHA6Ly9hcGkud29ybGRiYW5rLm9yZy9jb3VudHJ5LycgKyAkc2NvcGUuYWJicmV2aWF0aW9uICsgJy9pbmRpY2F0b3IvJyArIGNvbWJpbmVkSW5kaWNhdG9ycyArICc/c291cmNlPTImcGVyX3BhZ2U9MTAwJmRhdGU9MjAwNjoyMDE1JmZvcm1hdD1qc29uJztcbiAgICAvLyRodHRwKFxuICAgIC8vICAgIHtcbiAgICAvLyAgICAgICAgdXJsOiB3b3JsZEJhbmtBUElRdWVyeTEsXG4gICAgLy8gICAgICAgIGhlYWRlcnM6e1xuICAgIC8vICAgICAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJyxcbiAgICAvLyAgICAgICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJzogJ0dFVCwgUE9TVCwgUFVULCBERUxFVEUsIE9QVElPTlMnLFxuICAgIC8vICAgICAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnOiAnQ29udGVudC1UeXBlLCBYLVJlcXVlc3RlZC1XaXRoJ1xuICAgIC8vICAgICAgICAgICAgLy8nWC1SYW5kb20tU2hpdCc6JzEyMzEyMzEyMydcbiAgICAvLyAgICAgICAgfVxuICAgIC8vICAgIH0pXG4gICAgLy8gICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0cyl7XG4gICAgLy8gICAgICAgJHNjb3BlLndvcmxkQmFua0luZm8gPSByZXN1bHRzO1xuICAgIC8vICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzKTtcbiAgICAvL1xuICAgIC8vICAgICAgICByZXN1bHRzLnNoaWZ0KCk7XG4gICAgLy8gICAgICAgIHJlc3VsdHMgPSByZXN1bHRzWzBdO1xuICAgIC8vICAgICAgICB2YXIgY29tcGlsZWRJbmRpY2F0b3JzID0gW107XG4gICAgLy8gICAgICAgIHZhciBpbmRpY2F0b3JPYmogPSB7fTtcbiAgICAvLyAgICAgICAgdmFyIGRhdGUgPSAnMjAwNSc7XG4gICAgLy8gICAgICAgIHZhciBsYXN0SWQgPSByZXN1bHRzWzBdLmluZGljYXRvci5pZDtcbiAgICAvLyAgICAgICAgcmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uKGluZGljYXRvcil7XG4gICAgLy9cbiAgICAvLyAgICAgICAgICAgIGlmKGluZGljYXRvci5pbmRpY2F0b3IuaWQgIT0gbGFzdElkKXtcbiAgICAvLyAgICAgICAgICAgICAgICBjb21waWxlZEluZGljYXRvcnMucHVzaChpbmRpY2F0b3JPYmopO1xuICAgIC8vICAgICAgICAgICAgICAgIGluZGljYXRvck9iaj17fTtcbiAgICAvLyAgICAgICAgICAgICAgICBkYXRlID0gJzIwMDUnO1xuICAgIC8vICAgICAgICAgICAgfVxuICAgIC8vXG4gICAgLy8gICAgICAgICAgICBpZihpbmRpY2F0b3IuZGF0ZSA+IGRhdGUgJiYgaW5kaWNhdG9yLnZhbHVlKXtcbiAgICAvLyAgICAgICAgICAgICAgICBkYXRlID0gaW5kaWNhdG9yLmRhdGU7XG4gICAgLy8gICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqLmluZGljYXRvciA9IGluZGljYXRvci5pbmRpY2F0b3IudmFsdWU7XG4gICAgLy8gICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqLnZhbHVlID0gaW5kaWNhdG9yLnZhbHVlO1xuICAgIC8vICAgICAgICAgICAgICAgIGluZGljYXRvck9iai5kYXRlID0gZGF0ZTtcbiAgICAvLyAgICAgICAgICAgIH1cbiAgICAvL1xuICAgIC8vICAgICAgICAgICAgbGFzdElkID0gaW5kaWNhdG9yLmluZGljYXRvci5pZDtcbiAgICAvLyAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGluZGljYXRvck9iaik7XG4gICAgLy9cbiAgICAvL1xuICAgIC8vICAgICAgICB9KTtcbiAgICAvL1xuICAgIC8vICAgIH0pO1xuXG5cbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSl7XG4gICAgJHNjb3BlLnNpZ25JbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciB1c2VyID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6ICRzY29wZS5mb3JtLnVzZXJOYW1lLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICRzY29wZS5mb3JtLnBhc3N3b3JkXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnYXBpL2xvZ2luJywgdXNlcilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxufV0pO1xuXG5hcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywnJGh0dHAnLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCRyb290U2NvcGUsICRsb2NhdGlvbiwkaHR0cCl7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS9xdWVzdGlvbm5haXJlLycrJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKTtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL2xvZ291dCcpLlxuICAgICAgICAgICAgdGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2hvbWVcIik7XG4gICAgfVxufV0pO1xuXG5hcHAuY29udHJvbGxlcignaGVscENvbnRyb2xsZXInLFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcbiAgICAkc2NvcGUubWVzc2FnZSA9IFwiSSdtIGEgaGVscCBwYWdlIHRoYXQgY3VycmVudGx5IGRvZXNuJ3QgaGVscCBhdCBhbGxcIjtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3F1ZXN0aW9ubmFpcmVDb250cm9sbGVyJyxbJ2NvdW50cnlQYWdlJywndXNlclJlY29tbWVuZGF0aW9ucycsJ3F1ZXN0aW9ubmFpcmUnLCckcm9vdFNjb3BlJywnJHNjb3BlJywnJGxvY2F0aW9uJywgJyRodHRwJywnJGxvZycsJyRxJyxmdW5jdGlvbihjb3VudHJ5UGFnZSx1c2VyUmVjb21tZW5kYXRpb25zLHF1ZXN0aW9ubmFpcmUsJHJvb3RTY29wZSwkc2NvcGUsJGxvY2F0aW9uLCRodHRwLCRsb2csJHEpe1xuXG4gICAgaWYoISRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICB9XG5cbiAgICB2YXIgcXVlc3Rpb25zID0gcXVlc3Rpb25uYWlyZS5xdWVzdGlvbnM7XG4gICAgdmFyIHF1ZXN0aW9uUmVzcG9uc2VzID0ge307XG4gICAgdmFyIHVzZXJRdWVzdGlvbm5haXJlID0ge307XG5cbiAgICAkc2NvcGUucXVlc3Rpb25OdW0gPSAwO1xuICAgICRzY29wZS5kYXRhID0ge307XG4gICAgJHNjb3BlLmRhdGEgPSB7fTtcbiAgICAkc2NvcGUuYW5zd2VycyA9IFtdO1xuXG5cbiAgICAkc2NvcGUucXVlcnlTZWFyY2ggPSBmdW5jdGlvbihxdWVyeSkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKHF1ZXJ5KTtcbiAgICAgICAgLy9jb25zb2xlLmxvZygkc2NvcGUubGlzdCk7XG4gICAgICAgIHJldHVybiBxdWVyeSA/ICRzY29wZS5saXN0LmZpbHRlciggY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSApIDogJHNjb3BlLmxpc3Q7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGxvYWRBbGwoKSB7XG5cbiAgICAgICAgcmV0dXJuICRzY29wZS5saXN0Lm1hcCggZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBpdGVtXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gYW5ndWxhci5sb3dlcmNhc2UocXVlcnkpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4oaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIChpdGVtLnZhbHVlLmluZGV4T2YobG93ZXJjYXNlUXVlcnkpID09PSAwKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAkc2NvcGUucHVzaEFuc3dlciA9IGZ1bmN0aW9uKGFuc3dlcil7XG4gICAgICAgIGlmKGFuc3dlcil7XG4gICAgICAgICAgICAkc2NvcGUuYW5zd2Vycy5wdXNoKGFuc3dlcik7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5zaG93QW5zd2VycyA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJGh0dHAuZ2V0KCcvYXBpL3F1ZXN0aW9ubmFpcmUvJyskcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpLlxuICAgICAgICB0aGVuKGZ1bmN0aW9uKHVzZXJBbnN3ZXJzKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRyb290U2NvcGUudXNlci51c2VybmFtZSk7XG4gICAgICAgICAgICBpZih0eXBlb2YgdXNlckFuc3dlcnMuZGF0YSA9PSAnb2JqZWN0Jyl7XG4gICAgICAgICAgICAgICAgJGh0dHAucG9zdCgnL2FwaS93b3JsZEZhY3Rib29rJyx7bGFuZ3VhZ2VPcHRpb246dHJ1ZSxsYW5ndWFnZTp1c2VyQW5zd2Vycy5kYXRhLnF1ZXN0aW9uMX0pLlxuICAgICAgICAgICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKGNvdW50cmllc1RvU2VhcmNoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXJBbnN3ZXJzLGNvdW50cmllc1RvU2VhcmNoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNvbW1lbmRhdGlvbnMgPSBxdWVzdGlvbm5haXJlLmRldGVybWluZVJlY29tbWVuZGF0aW9ucyh1c2VyQW5zd2Vycy5kYXRhLGNvdW50cmllc1RvU2VhcmNoLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlclJlY29tbWVuZGF0aW9ucy5jb3VudHJpZXMgPSAkc2NvcGUucmVjb21tZW5kYXRpb25zO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFF1ZXN0aW9uKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3QgPSBsb2FkQWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgJHNjb3BlLmdldFF1ZXN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJHNjb3BlLmRhdGEuc2hvd0Fuc3dlcnMgPSBmYWxzZTtcblxuICAgICAgICBpZigkc2NvcGUucXVlc3Rpb25OdW09PXF1ZXN0aW9ucy5sZW5ndGgpe1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXN0aW9uID0gJ1lvdXIgbGlzdCBpcyBiZWluZyBnZW5lcmF0ZWQhJztcbiAgICAgICAgICAgIHVzZXJRdWVzdGlvbm5haXJlLnVzZXJuYW1lID0gJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lO1xuICAgICAgICAgICAgdXNlclF1ZXN0aW9ubmFpcmUucXVlc3Rpb25SZXNwb25zZXMgPSBxdWVzdGlvblJlc3BvbnNlcztcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvcXVlc3Rpb25uYWlyZScsdXNlclF1ZXN0aW9ubmFpcmUpO1xuICAgICAgICAgICAgJGh0dHAucG9zdCgnL2FwaS93b3JsZEZhY3Rib29rJyx7bGFuZ3VhZ2VPcHRpb246dHJ1ZSxsYW5ndWFnZTpxdWVzdGlvblJlc3BvbnNlcy5xdWVzdGlvbjF9KS5cbiAgICAgICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKGNvdW50cmllc1RvU2VhcmNoKXtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlY29tbWVuZGF0aW9ucyA9IHF1ZXN0aW9ubmFpcmUuZGV0ZXJtaW5lUmVjb21tZW5kYXRpb25zKHF1ZXN0aW9uUmVzcG9uc2VzLGNvdW50cmllc1RvU2VhcmNoLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB1c2VyUmVjb21tZW5kYXRpb25zLmNvdW50cmllcyA9ICRzY29wZS5yZWNvbW1lbmRhdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkc2NvcGUudHlwZSA9ICcnO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbiA9IHF1ZXN0aW9uc1skc2NvcGUucXVlc3Rpb25OdW1dLnF1ZXN0aW9uO1xuICAgICAgICAgICAgJHNjb3BlLnR5cGUgPSBxdWVzdGlvbnNbJHNjb3BlLnF1ZXN0aW9uTnVtXS50eXBlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnF1ZXN0aW9uLCAkc2NvcGUudHlwZSk7XG4gICAgICAgICAgICBpZigkc2NvcGUudHlwZSA9PSAnbGlzdCcpe1xuICAgICAgICAgICAgICAgICRzY29wZS5saXN0ID0gcXVlc3Rpb25zWyRzY29wZS5xdWVzdGlvbk51bV0uYW5zd2VyT3B0aW9ucztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfTtcbiAgICAkc2NvcGUubG9nQW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKXtcbiAgICAgICAgJHNjb3BlLmRhdGEuc2hvd0Fuc3dlcnMgPSBmYWxzZTtcblxuICAgICAgICAkc2NvcGUucXVlc3Rpb25OdW0rKztcblxuICAgICAgICBpZihhbnN3ZXIuY29uc3RydWN0b3IgPT09IEFycmF5KXtcbiAgICAgICAgICAgIGFuc3dlciA9IGFuc3dlci5qb2luKCcgJylcbiAgICAgICAgfVxuICAgICAgICBxdWVzdGlvblJlc3BvbnNlc1tcInF1ZXN0aW9uXCIrKCRzY29wZS5xdWVzdGlvbk51bSldID0gYW5zd2VyO1xuXG4gICAgICAgICRzY29wZS5hbnN3ZXJzID0gW107XG4gICAgICAgICRzY29wZS5zZWFyY2hUZXh0ID0gJyc7XG5cbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZENvdW50cnkgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3VzZXJDb3VudHJpZXMnLHt1c2VybmFtZTogJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lLHVzZXJDb3VudHJpZXM6IFsnZnJhbmNlJywnZ2VybWFueScsJ3NwYWluJ119KS5cbiAgICAgICAgICAgIHRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VyQ291bnRyaWVzID0gcmVzcG9uc2UudXNlckNvdW50cmllcztcbiAgICAgICAgICAgIH0pXG4gICAgfTtcblxuICAgICRzY29wZS5zZXRDb3VudHJ5UGFnZSA9IGZ1bmN0aW9uKGNvdW50cnlOYW1lKXtcbiAgICAgICAgY291bnRyeVBhZ2UubmFtZSA9IGNvdW50cnlOYW1lO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZGVsZXRlUXVlc3Rpb25uYWlyZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICRodHRwLmRlbGV0ZSgnYXBpL3F1ZXN0aW9ubmFpcmUvJyskcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZWQhJyk7XG4gICAgICAgICAgICAgICAgdXNlclJlY29tbWVuZGF0aW9ucyA9IHt9O1xuICAgICAgICAgICAgICAgICRzY29wZS5yZWNvbW1lbmRhdGlvbnMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucXVlc3Rpb25OdW0gPSAwO1xuICAgICAgICAgICAgICAgICRzY29wZS5nZXRRdWVzdGlvbigpO1xuICAgICAgICAgICAgICAgICRzY29wZS5saXN0ID0gbG9hZEFsbCgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbn1dKTtcblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpIHtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIGNvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pO1xuXG5hcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgY29uc29sZS5sb2coY29uZmlnLnVybCk7XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYoJGxvY2F0aW9uLnNlYXJjaCgpLmFjY2Vzc190b2tlbil7XG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKCRsb2NhdGlvbi5zZWFyY2goKS5hY2Nlc3NfdG9rZW4pO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2FjY2Vzc190b2tlbicsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ3F1ZXN0aW9ubmFpcmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcXVlc3Rpb25zOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246IFwiV2hhdCBsYW5ndWFnZShzKSBkbyB5b3Ugc3BlYWs/XCIsIHR5cGU6ICdsaXN0JyxcbiAgICAgICAgICAgICAgICBhbnN3ZXJPcHRpb25zOiBbJ0FkeWdoZScsICdBbGJhbmlhbicsICdBcmFnb25lc2UnLCAnQXJtZW5pYW4nLCAnQXJvbWFuaWFuJywgJ0FycGl0YW4nLCAnQXN0dXJpYW4nLCAnQXZhcicsICdBemVyYmFpamFuaScsICdCYXNoa2lyJywgJ0Jhc3F1ZScsICdCZWxhcnVzaWFuJywgJ0Jvc25pYW4nLCAnQnJldG9uJywgJ0J1bGdhcmlhbicsICdDYXRhbGFuJywgJ0NoZWNoZW4nLCAnQ2h1dmFzaCcsICdDb3JuaXNoJywgJ0NvcnNpY2FuJywgJ0NyaW1lYW4nLCAnQ3JvYXRpYW4nLCAnQ3plY2gnLCAnRGFuaXNoJywgJ0R1dGNoJywgJ0VuZ2xpc2gnLCAnRXJ6eWEnLCAnRXN0b25pYW4nLCAnRmFyb2VzZScsICdGaW5uaXNoJywgJ0ZyZW5jaCcsICdGcmlzaWFuJywgJ0dhZ2F1eicsICdHYWxpY2lhbicsICdHYWxsbycsICdHZW9yZ2lhbicsICdHZXJtYW4nLCAnR3JlZWsnLCAnSHVuZ2FyaWFuJywgJ0ljZWxhbmRpYycsICdJbmdyaWFuJywgJ0lyaXNoJywgJ0l0YWxpYW4nLCAnS2FiYXJkaWFuJywgJ0thc2h1YmlhbicsICdLYXpha2gnLCAnTGFkaW4nLCAnTGF0aW4nLCAnTGF0dmlhbicsICdMYXonLCAnTGl0aHVhbmlhbicsICdMdXhlbWJvdXJnaXNoJywgJ01hY2Vkb25pYW4nLCAnTWFsdGVzZScsICdNYW54JywgJ01hcmknLCAnTWluZ3JlbGlhbicsICdNaXJhbmRlc2UnLCAnTW9udGVuZWdyaW4nLCAnTm9yd2VnaWFuJywgJ09jY2l0YW4nLCAnT3NzZXRpYW4nLCAnUGljYXJkJywgJ1BvbGlzaCcsICdQb3J0dWd1ZXNlJywgJ1JvbWFuaScsICdSb21hbmlhbicsICdSb21hbnNoJywgJ1J1c3NpYW4nLCAnU2FtaScsICdTYXJkaW5pYW4nLCAnU2NvdHMnLCAnU2NvdHRpc2gnLCdHYWVsaWMnLCAnU2VyYmlhbicsICdTaWxlc2lhbicsICdTbG92YWsnLCAnU2xvdmVuZScsICdTb3JiaWFuJywgJ1NwYW5pc2gnLCAnU3ZhbicsICdTd2VkaXNoJywgJ1RhYmFzYXJhbicsICdUYXRhcicsICdUdXJraXNoJywgJ1VrcmFpbmlhbicsICdWZXBzaWFuJywgJ1bDtXJvJywgJ1dhbGxvb24nLCAnV2Vsc2gnLCAnV3lteXNvcnlzJ11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IGZpZWxkIGRvIHlvdSB3b3JrIGluPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnQWdyaWN1bHR1cmUnLCAnSW5kdXN0cnknLCAnU2VydmljZXMnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgY2xpbWF0ZShzKSB3b3VsZCB5b3UgcHJlZmVyPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnVGVtcGVyYXRlJywgJ01lZGl0ZXJyYW5lYW4nLCAnVHJvcGljYWwnLCAnQXJpZCcsICdEZXNlcnQnLCAnTWFyaXRpbWUnLCAnV2V0J11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IGlzIHRoZSBpZGVhbCBzaXplIGZvciB0aGUgbGFyZ2VzdCBtZXRyb3BvbGl0YW4gYXJlYT8nLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdsaXN0JyxcbiAgICAgICAgICAgICAgICBhbnN3ZXJPcHRpb25zOiBbJ1NtYWxsICg8MTAwLDAwMCknLCAnTWVkaXVtICgxMDAsMDAwLTEgbWlsbGlvbiknLCAnTGFyZ2UgKD4xIG1pbGxpb24pJ11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXb3VsZCB5b3UgbGlrZSB0aGUgcG9wdWxhdGlvbiBkaXN0cmlidXRpb24gdG8gYmUgbW9zdGx5IHVyYmFuPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAnV2hhdCB3b3VsZCB5b3VyIGlkZWFsIG1lZGlhbiBhZ2UgcmFuZ2UgYmU/JywgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnMjAtMzB5cnMnLCAnMzAtNDB5cnMnLCAnNDAreWVhcnMnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgY29zdCBvZiBsaXZpbmcgc2hvdWxkIHlvdXIgZGVzdGluYXRpb24gaGF2ZT8nLCB0eXBlOidsaXN0JyxcbiAgICAgICAgICAgICAgICBhbnN3ZXJPcHRpb25zOiBbJ0hpZ2gnLCdBdmVyYWdlJywnTG93J11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IHBlcmNlbnRhZ2Ugb2YgdGhlIHBvcHVsYXRpb24gc2hvdWxkIGJlIGludGVybmV0IHVzZXJzPycsIHR5cGU6J2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnPDI1JScsJzI1JS01MCUnLCc1MCUtNzUlJywnPjc1JSddXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIGRldGVybWluZVJlY29tbWVuZGF0aW9uczogZnVuY3Rpb24ocXVlc3Rpb25uYWlyZUFuc3dlcnMsY291bnRyaWVzVG9TZWFyY2gpe1xuXG4gICAgICAgICAgICBjb3VudHJpZXMgPSBbXTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UHJvcG9ydGlvbmFsU2NvcmUobG93ZXJMaW1pdCx1cHBlckxpbWl0LHZhbHVlKXtcblxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA+PSBsb3dlckxpbWl0ICYmIHZhbHVlIDw9IHVwcGVyTGltaXQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTA7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW1pdCA9IE1hdGguYWJzKHZhbHVlLWxvd2VyTGltaXQpID4gTWF0aC5hYnModmFsdWUtdXBwZXJMaW1pdCkgPyB1cHBlckxpbWl0IDogbG93ZXJMaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG11bHRpcGxpZXIgPSB2YWx1ZSA+IGxpbWl0ID8gMC41IDogMS41O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcmUgPSAyMCooMSAtIE1hdGgubWluKDEsTWF0aC5hYnModmFsdWUgLSBtdWx0aXBsaWVyKmxpbWl0KS9saW1pdCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb3VudHJpZXNUb1NlYXJjaC5mb3JFYWNoKGZ1bmN0aW9uKGNvdW50cnksaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcmUgPSAwLCB1cHBlckxpbWl0LCBsb3dlckxpbWl0LCBjbGltYXRlU3RyaW5nO1xuICAgICAgICAgICAgICAgIHZhciBsYWJvclBlcmNlbnQgPSBjb3VudHJ5LmxhYm9yW3F1ZXN0aW9ubmFpcmVBbnN3ZXJzLnF1ZXN0aW9uMl0gfHwgMDtcbiAgICAgICAgICAgICAgICAvL2lmIHVzZXIncyBzcGVjaWZpZWQgaW5kdXN0cnkgaXMgbW9yZSB0aGFuIDc1JSBvZiB0aGUgY291bnRyeSdzIHdvcmtmb3JjZSwgc2V0IHNjb3JlIHRvIDEwXG4gICAgICAgICAgICAgICAgdmFyIGxhYm9yU2NvcmUgPSBsYWJvclBlcmNlbnQvNy41ID4gMTAgPyAxMCA6IGxhYm9yUGVyY2VudC8xMDtcbiAgICAgICAgICAgICAgICAvL2NyZWF0ZSBSZWd1bGFyIEV4cHJlc3Npb24gdG8gY2hlY2sgY2xpbWF0ZSBzdHJpbmcgZm9yIGNsaW1hdGUgYW5zd2Vyc1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb24zID09ICdhcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpbWF0ZVN0cmluZyA9IG5ldyBSZWdFeHAocXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb24zLmpvaW4oJ3wnKSwnaScpO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBjbGltYXRlU3RyaW5nID0gbmV3IFJlZ0V4cChxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjMsJ2knKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiBjbGltYXRlIHN0cmluZyBjb250YWlucyBvbmUgb2YgdGhlIGNsaW1hdGUgYW5zd2Vycywgc2V0IHNjb3JlIHRvIDEwXG4gICAgICAgICAgICAgICAgdmFyIGNsaW1hdGVTY29yZSA9IGNvdW50cnkuY2xpbWF0ZS5tYXRjaChjbGltYXRlU3RyaW5nKSAhPSBudWxsID8gMTA6IDA7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlckxhcmdlc3RDaXR5UG9wID0gcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb240O1xuICAgICAgICAgICAgICAgIHN3aXRjaCh1c2VyTGFyZ2VzdENpdHlQb3Ape1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdTbWFsbCAoPDEwMCwwMDApJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDFFNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdNZWRpdW0gKDEwMCwwMDAtMSBtaWxsaW9uKSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMUU1O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDFFNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdMYXJnZSAoPjEgbWlsbGlvbiknOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDFFNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAxRTIwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxhcmdlc3RDaXR5UG9wU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5sYXJnZXN0Q2l0eVBvcCkgfHwgMDtcblxuICAgICAgICAgICAgICAgIHZhciB1c2VyVXJiYW5Qb3B1bGF0aW9uID0gcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb241O1xuICAgICAgICAgICAgICAgIHZhciB1cmJhblBvcHVsYXRpb25TY29yZTtcbiAgICAgICAgICAgICAgICBpZih1c2VyVXJiYW5Qb3B1bGF0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgdXJiYW5Qb3B1bGF0aW9uU2NvcmUgPSBjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbiA+IDUwID8gMTAgOiAxMCpjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbi81MDtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdXJiYW5Qb3B1bGF0aW9uU2NvcmUgPSBjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbiA8IDUwID8gMTAgOiAxMCo1MC9jb3VudHJ5LnVyYmFuUG9wdWxhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlck1lZGlhbkFnZSA9IHF1ZXN0aW9ubmFpcmVBbnN3ZXJzLnF1ZXN0aW9uNjtcbiAgICAgICAgICAgICAgICBzd2l0Y2godXNlck1lZGlhbkFnZSl7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzIwLTMweXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDMwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzMwLTQweXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAzMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA0MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICc0MCt5ZWFycyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gNDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMTUwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVkaWFuQWdlU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5tZWRpYW5BZ2UpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJQZXJDYXBpdGFQUFAgPSBxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjc7XG4gICAgICAgICAgICAgICAgc3dpdGNoKHVzZXJQZXJDYXBpdGFQUFApe1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdIaWdoJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSA2MDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAxRTEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0F2ZXJhZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDMwMDAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDYwMDAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAzMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwZXJDYXBpdGFQUFBTY29yZSA9IGdldFByb3BvcnRpb25hbFNjb3JlKGxvd2VyTGltaXQsdXBwZXJMaW1pdCxjb3VudHJ5LnBlckNhcGl0YVBQUCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlckludGVybmV0VXNhZ2VQZXJDYXBpdGEgPSBxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjg7XG4gICAgICAgICAgICAgICAgc3dpdGNoKHVzZXJJbnRlcm5ldFVzYWdlUGVyQ2FwaXRhKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnPDI1JSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAyNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICcyNSUtNTAlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAyNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICc1MCUtNzUlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA3NTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDc1O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnRlcm5ldFVzYWdlU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5pbnRlcm5ldFVzYWdlUGVyQ2FwaXRhKTtcbiAgICAgICAgICAgICAgICBzY29yZSA9IHNjb3JlICsgbGFib3JTY29yZSArIGNsaW1hdGVTY29yZSArIGxhcmdlc3RDaXR5UG9wU2NvcmUgKyB1cmJhblBvcHVsYXRpb25TY29yZSArIHBlckNhcGl0YVBQUFNjb3JlICsgbWVkaWFuQWdlU2NvcmUgKyBpbnRlcm5ldFVzYWdlU2NvcmU7XG4gICAgICAgICAgICAgICAgY291bnRyeS5zY29yZSA9IHNjb3JlO1xuICAgICAgICAgICAgICAgIGNvdW50cmllcy5wdXNoKGNvdW50cnkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvdW50cmllcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGEuc2NvcmUgPiBiLnNjb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGEuc2NvcmUgPCBiLnNjb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihhLmNvdW50cnlOYW1lID4gYi5jb3VudHJ5TmFtZSl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihhLmNvdW50cnlOYW1lIDwgYi5jb3VudHJ5TmFtZSl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcy5zbGljZSgwLDQpO1xuICAgICAgICB9XG4gICAgfTtcbn0pO1xuXG5hcHAuZmFjdG9yeSgnY291bnRyeVBhZ2UnLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHt9O1xufSk7XG5cbmFwcC5mYWN0b3J5KCd1c2VyUmVjb21tZW5kYXRpb25zJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7fTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9