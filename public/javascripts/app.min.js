var app=angular.module("NextPat",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0),e.when("/",{templateUrl:"/views/home.html",controller:"mainController"}).when("/about",{templateUrl:"/views/about.html",controller:"aboutController"}).when("/contact",{templateUrl:"/views/contact.html",controller:"contactController"}).when("/login",{templateUrl:"/views/login.html",controller:"loginController"}).when("/signUp",{templateUrl:"/views/signUp.html",controller:"loginController"}).when("/questionnaire",{templateUrl:"/views/questionnaire.html",controller:"questionnaireController"}).when("/help",{templateUrl:"/views/help.html",controller:"helpController"}).otherwise({redirectTo:"/"})}]),app.controller("mainController",["$scope","$location",function(e,t){var n=[{question:"Have you been here before?",route:"login"},{question:"Would you like to sign up?",route:"signUp"},{question:"Okay, your information will not be saved."}];e.question=n[0].question;var o=0;e.showButtons=!0,e.getQuestion=function(a){var r=(n[o].question,n[o].route);a?t.path(r):(o++,e.question=n[o].question,o==n.length-1&&(e.showButtons=!1))}}]),app.controller("aboutController",["$scope",function(e){e.message="I'm a page that describes this application!"}]),app.controller("contactController",["$scope",function(e){e.message="I'm a page that tells you how to yell (by writing an all-caps email) at the developer!"}]),app.controller("signUpController",["$scope","$http",function(e,t){}]),app.controller("loginController",["$scope","$http","authService","$location","$rootScope",function(e,t,n,o,a){e.submit=function(){t.post("api/login",e.form).then(function(e){n.saveToken(e.data),a.user=n.getUser(),o.path("/questionnaire")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(e,t,n,o){n.user=e.getUser(),n.user&&n.user.username&&o.path("/questionnaire"),t.logout=function(){e.logout(),n.user=e.getUser(),o.path("/login")}}]),app.controller("helpController",["$scope",function(e){e.message="I'm a help page that currently doesn't help at all"}]),app.controller("questionnaireController",["questionnaire","$rootScope","$scope","$location","$http",function(e,t,n,o,a){var r=1;n.type=questions[0].type,n.question=questions[0].question,n.getQuestion=function(e){r==questions.length?(n.question="Your list is being generated!",n.type=""):(n.question=questions[r].question,n.type=questions[r].type,"list"==n.type&&(n.list=questions[r].answerOptions),questions[r-1].answer=e,r++)},n.addCountry=function(){a.post("/api/userCountries",{username:t.user.username,userCountries:["france","germany","spain"]}).then(function(e){n.userCountries=e.userCountries})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var n=t.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(e.atob(o))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),n=Math.round((new Date).getTime()/1e3)<=t.exp;return n||this.logout(),n}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},n.isAuthed()&&(e.headers.Authorization="Bearer "+n.getToken()),e},response:function(n){return 401===n.status&&t.path("/login"),n||e.when(n)},responseError:function(n){return 401===n.status?t.path("/login"):console.log(n),e.reject(n)}}}]),app.factory("questionnaire",function(){return{questions:[{question:"What language(s) do you speak?",type:"list",answerOptions:["Adyghe","Albanian","Aragonese","Armenian","Aromanian","Arpitan","Asturian","Avar","Azerbaijani","Bashkir","Basque","Belarusian","Bosnian","Breton","Bulgarian","Catalan","Chechen","Chuvash","Cornish","Corsican","Crimean","Tatar","Croatian","Czech","Danish","Dutch","English","Erzya","Estonian","Faroese","Finnish","French","Frisian","Gagauz","Galician","Gallo","Georgian","German","Greek","Hungarian","Icelandic","Ingrian","Irish","Italian","Kabardian","Kashubian","Kazakh","Ladin","Latin","Latvian","Laz","Lithuanian","Luxembourgish","Macedonian","Maltese","Manx","Mari","Mingrelian","Mirandese","Montenegrin","Norwegian","Occitan","Ossetian","Picard","Polish","Portuguese","Romani","Romanian","Romansh","Russian","Sami","Sardinian","Scots","Scottish","Gaelic","Serbian","Silesian","Slovak","Slovene","Sorbian","Spanish","Svan","Swedish","Tabasaran","Tatar","Turkish","Ukrainian","Vepsian","VÃµro","Walloon","Welsh","Wymysorys"]},{question:"What field do you work in?",type:"list",answerOptions:["Agriculture","Industry","Services"]},{question:"What climate(s) would you prefer?",type:"list",answerOptions:["Temperate","Mediterranean","Tropical","Arid","Desert","Maritime","Wet"]},{question:"What is the ideal size for the largest metropolitan area?",type:"list",answerOptions:["Small (<100,000)","Medium (100,000-1 million)","Large (>1 million)"]},{question:"Would you like the population distribution to be mostly urban?",type:"boolean"},{question:"What would your ideal median age range be?",type:"list",answerOptions:["20-30yrs","30-40yrs","40+years"]},{question:"What cost of living should your destination have?",type:"list",answerOptions:["High","Average","Low"]},{question:"What percentage of the population should be internet users?",type:"list",answerOptions:["<25%","25%-50%","50%-75%",">75%"]}],determineRecommendations:function(e,t){function n(e,t,n){if(n>=t&&e>=n)return 10;var o=1-Math.abs(n-t)/t,a=1-Math.abs(n-t)/e;return 10*Math.min(o,a)}return countries=[],t.forEach(function(t,o){var a=0,r=t.labor[e.question2],i=r/7.5>10?10:r/10,s=new RegExp(e.question3.join("|")),l=null!=t.climate.match(s)?10:0,u=e.question4;switch(u){case"Small (<100,000)":d=0,m=1e5;break;case"Medium (100,000-1 million)":d=1e5,m=1e6;break;case"Large (>1 million)":d=1e6,m=1e20}var c,p=n(d,m,t.largestCityPop),h=e.question5;c=h?t.urbanPopulation>50?10:10*t.urbanPopulation/50:t.urbanPopulation<50?10:500/t.urbanPopulation;var g=e.question6;switch(g){case"20-30yrs":d=0,m=30;break;case"30-40yrs":d=30,m=40;break;case"40+years":d=40,m=150}var m,d,w=e.question7;switch(w){case"High":d=6e4,m=1e10;break;case"Average":d=3e4,m=6e4;break;case"Low":d=0,m=3e4}var y=n(d,m,t.perCapitaPPP),f=n(d,m,t.medianAge),q=e.question8;switch(q){case"<25%":d=0,m=25;break;case"25%-50%":d=25,m=50;break;case"50%-75%":d=50,m=75;break;default:d=75,m=100}var v=n(d,m,t.internetUsagePerCapita);a=a+i+l+p+c+y+f+v,t.score=a,countries.push(t)}),countries.sort(function(e,t){return e.score>t.score?-1:e.score<t.score?1:e.countryName>t.countryName?1:e.countryName<t.countryName?-1:0}),countries.slice(0,4)}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsImh0bWw1TW9kZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiJHNjb3BlIiwiJGxvY2F0aW9uIiwiaW50cm9RdWVzdGlvbnMiLCJxdWVzdGlvbiIsInJvdXRlIiwicXVlc3Rpb25OdW0iLCJzaG93QnV0dG9ucyIsImdldFF1ZXN0aW9uIiwiYW5zd2VyIiwicGF0aCIsImxlbmd0aCIsIm1lc3NhZ2UiLCIkaHR0cCIsImF1dGhTZXJ2aWNlIiwiJHJvb3RTY29wZSIsInN1Ym1pdCIsInBvc3QiLCJmb3JtIiwidGhlbiIsInJlc3BvbnNlIiwic2F2ZVRva2VuIiwiZGF0YSIsInVzZXIiLCJnZXRVc2VyIiwidXNlcm5hbWUiLCJsb2dvdXQiLCJxdWVzdGlvbm5haXJlIiwidHlwZSIsInF1ZXN0aW9ucyIsImxpc3QiLCJhbnN3ZXJPcHRpb25zIiwiYWRkQ291bnRyeSIsInVzZXJDb3VudHJpZXMiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiY29uc29sZSIsImxvZyIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJmYWN0b3J5IiwiJHEiLCJyZXF1ZXN0IiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0IiwiZGV0ZXJtaW5lUmVjb21tZW5kYXRpb25zIiwicXVlc3Rpb25uYWlyZUFuc3dlcnMiLCJjb3VudHJpZXNUb1NlYXJjaCIsImdldFByb3BvcnRpb25hbFNjb3JlIiwidXBwZXJMaW1pdCIsImxvd2VyTGltaXQiLCJ2YWx1ZSIsImxvd1Njb3JlIiwiYWJzIiwiaGlnaFNjb3JlIiwibWluIiwiY291bnRyaWVzIiwiZm9yRWFjaCIsImNvdW50cnkiLCJpbmRleCIsInNjb3JlIiwibGFib3JQZXJjZW50IiwibGFib3IiLCJxdWVzdGlvbjIiLCJsYWJvclNjb3JlIiwiY2xpbWF0ZVN0cmluZyIsIlJlZ0V4cCIsInF1ZXN0aW9uMyIsImpvaW4iLCJjbGltYXRlU2NvcmUiLCJjbGltYXRlIiwibWF0Y2giLCJ1c2VyTGFyZ2VzdENpdHlQb3AiLCJxdWVzdGlvbjQiLCJ1cmJhblBvcHVsYXRpb25TY29yZSIsImxhcmdlc3RDaXR5UG9wU2NvcmUiLCJsYXJnZXN0Q2l0eVBvcCIsInVzZXJVcmJhblBvcHVsYXRpb24iLCJxdWVzdGlvbjUiLCJ1cmJhblBvcHVsYXRpb24iLCJ1c2VyTWVkaWFuQWdlIiwicXVlc3Rpb242IiwidXNlclBlckNhcGl0YVBQUCIsInF1ZXN0aW9uNyIsInBlckNhcGl0YVBQUFNjb3JlIiwicGVyQ2FwaXRhUFBQIiwibWVkaWFuQWdlU2NvcmUiLCJtZWRpYW5BZ2UiLCJ1c2VySW50ZXJuZXRVc2FnZVBlckNhcGl0YSIsInF1ZXN0aW9uOCIsImludGVybmV0VXNhZ2VTY29yZSIsImludGVybmV0VXNhZ2VQZXJDYXBpdGEiLCJwdXNoIiwic29ydCIsImEiLCJiIiwiY291bnRyeU5hbWUiLCJzbGljZSJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxXQUFBLFdBRUFGLEtBQUFHLFFBQUEsaUJBQUEsb0JBQUEsU0FBQUMsRUFBQUMsR0FFQUEsRUFBQUMsV0FBQSxHQUVBRixFQUFBRyxLQUFBLEtBRUFDLFlBQUEsbUJBQ0FDLFdBQUEsbUJBQ0FGLEtBQUEsVUFFQUMsWUFBQSxvQkFDQUMsV0FBQSxvQkFDQUYsS0FBQSxZQUVBQyxZQUFBLHNCQUNBQyxX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LEVBQUEsSUFLQSxHQUFBbUMsR0FBQXBDLEVBQUFFLEVBQUFELEVBQUFTLEVBQUEyQixjQUdBQyxFQUFBdEMsRUFBQUUsRUFBQUQsRUFBQVMsRUFBQTZCLFdBRUFDLEVBQUExQyxFQUFBMkMsU0FDQSxRQUFBRCxHQUNBLElBQUEsT0FDQXRDLEVBQUEsRUFDQUQsRUFBQSxFQUNBLE1BQ0EsS0FBQSxVQUNBQyxFQUFBLEdBQ0FELEVBQUEsRUFDQSxNQUNBLEtBQUEsVUFDQUMsRUFBQSxHQUNBRCxFQUFBLEVBQ0EsTUFDQSxTQUNBQyxFQUFBLEdBQ0FELEVBQUEsSUFJQSxHQUFBeUMsR0FBQTFDLEVBQUFFLEVBQUFELEVBQUFTLEVBQUFpQyx1QkFFQS9CLEdBQUFBLEVBQUFJLEVBQUFLLEVBQUFNLEVBQUFELEVBQUFVLEVBQUFFLEVBQUFJLEVBQ0FoQyxFQUFBRSxNQUFBQSxFQUNBSixVQUFBb0MsS0FBQWxDLEtBR0FGLFVBQUFxQyxLQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUQsR0FBQWxDLE1BQUFtQyxFQUFBbkMsTUFDQSxHQUVBa0MsRUFBQWxDLE1BQUFtQyxFQUFBbkMsTUFDQSxFQUVBa0MsRUFBQUUsWUFBQUQsRUFBQUMsWUFDQSxFQUVBRixFQUFBRSxZQUFBRCxFQUFBQyxZQUNBLEdBRUEsSUFHQXhDLFVBQUF5QyxNQUFBLEVBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnTmV4dFBhdCcsIFsnbmdSb3V0ZSddKTtcblxuYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpe1xuXG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9hYm91dCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Fib3V0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Fib3V0Q29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL2NvbnRhY3QnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jb250YWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NvbnRhY3RDb250cm9sbGVyJ1xuICAgICAgICB9KS53aGVuKCcvbG9naW4nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9zaWduVXAnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zaWduVXAuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5Db250cm9sbGVyJ1xuICAgICAgICB9KS53aGVuKCcvcXVlc3Rpb25uYWlyZScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3F1ZXN0aW9ubmFpcmUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncXVlc3Rpb25uYWlyZUNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9oZWxwJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvaGVscC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdoZWxwQ29udHJvbGxlcidcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgfSk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdtYWluQ29udHJvbGxlcicsIFsnJHNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCRsb2NhdGlvbil7XG5cbiAgICB2YXIgaW50cm9RdWVzdGlvbnMgPSBbe3F1ZXN0aW9uOiBcIkhhdmUgeW91IGJlZW4gaGVyZSBiZWZvcmU/XCIsIHJvdXRlOidsb2dpbid9LFxuICAgICAgICB7cXVlc3Rpb246IFwiV291bGQgeW91IGxpa2UgdG8gc2lnbiB1cD9cIiwgcm91dGU6ICdzaWduVXAnfSxcbiAgICAgICAge3F1ZXN0aW9uOiBcIk9rYXksIHlvdXIgaW5mb3JtYXRpb24gd2lsbCBub3QgYmUgc2F2ZWQuXCJ9XTtcbiAgICAkc2NvcGUucXVlc3Rpb24gPSBpbnRyb1F1ZXN0aW9uc1swXS5xdWVzdGlvbjtcbiAgICB2YXIgcXVlc3Rpb25OdW0gPSAwO1xuICAgICRzY29wZS5zaG93QnV0dG9ucyA9IHRydWU7XG4gICAgJHNjb3BlLmdldFF1ZXN0aW9uID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgIHZhciBxdWVzdGlvblRleHQgPSBpbnRyb1F1ZXN0aW9uc1txdWVzdGlvbk51bV0ucXVlc3Rpb247XG4gICAgICAgIHZhciByb3V0ZSA9IGludHJvUXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS5yb3V0ZTtcbiAgICAgICAgaWYgKGFuc3dlcikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgocm91dGUpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICBxdWVzdGlvbk51bSsrO1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXN0aW9uID0gaW50cm9RdWVzdGlvbnNbcXVlc3Rpb25OdW1dLnF1ZXN0aW9uO1xuICAgICAgICAgICAgaWYocXVlc3Rpb25OdW0gPT0gaW50cm9RdWVzdGlvbnMubGVuZ3RoLTEpe1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93QnV0dG9ucyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2Fib3V0Q29udHJvbGxlcicsIFsnJHNjb3BlJyxmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBwYWdlIHRoYXQgZGVzY3JpYmVzIHRoaXMgYXBwbGljYXRpb24hXCI7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdjb250YWN0Q29udHJvbGxlcicsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBwYWdlIHRoYXQgdGVsbHMgeW91IGhvdyB0byB5ZWxsIChieSB3cml0aW5nIGFuIGFsbC1jYXBzIGVtYWlsKSBhdCB0aGUgZGV2ZWxvcGVyIVwiO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignc2lnblVwQ29udHJvbGxlcicsWyckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwkaHR0cCl7XG5cblxufV0pO1xuXG5hcHAuY29udHJvbGxlcignbG9naW5Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKXtcbiAgICAkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnYXBpL2xvZ2luJywgJHNjb3BlLmZvcm0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL3F1ZXN0aW9ubmFpcmVcIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwkcm9vdFNjb3BlLCAkbG9jYXRpb24pe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3F1ZXN0aW9ubmFpcmUnKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgfVxufV0pO1xuXG5hcHAuY29udHJvbGxlcignaGVscENvbnRyb2xsZXInLFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcbiAgICAkc2NvcGUubWVzc2FnZSA9IFwiSSdtIGEgaGVscCBwYWdlIHRoYXQgY3VycmVudGx5IGRvZXNuJ3QgaGVscCBhdCBhbGxcIjtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3F1ZXN0aW9ubmFpcmVDb250cm9sbGVyJyxbJ3F1ZXN0aW9ubmFpcmUnLCckcm9vdFNjb3BlJywnJHNjb3BlJywnJGxvY2F0aW9uJywgJyRodHRwJywgZnVuY3Rpb24ocXVlc3Rpb25uYWlyZSwkcm9vdFNjb3BlLCRzY29wZSwkbG9jYXRpb24sJGh0dHApe1xuXG4gICAgdmFyIHF1ZXN0aW9uTnVtID0gMTtcbiAgICAkc2NvcGUudHlwZSA9IHF1ZXN0aW9uc1swXS50eXBlO1xuICAgICRzY29wZS5xdWVzdGlvbiA9IHF1ZXN0aW9uc1swXS5xdWVzdGlvbjtcbiAgICAkc2NvcGUuZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbihhbnN3ZXIpe1xuXG4gICAgICAgIGlmKHF1ZXN0aW9uTnVtPT1xdWVzdGlvbnMubGVuZ3RoKXtcbiAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbiA9ICdZb3VyIGxpc3QgaXMgYmVpbmcgZ2VuZXJhdGVkISc7XG4gICAgICAgICAgICAkc2NvcGUudHlwZSA9ICcnO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbiA9IHF1ZXN0aW9uc1txdWVzdGlvbk51bV0ucXVlc3Rpb247XG4gICAgICAgICAgICAkc2NvcGUudHlwZSA9IHF1ZXN0aW9uc1txdWVzdGlvbk51bV0udHlwZTtcblxuICAgICAgICAgICAgaWYoJHNjb3BlLnR5cGUgPT0gJ2xpc3QnKXtcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlzdCA9IHF1ZXN0aW9uc1txdWVzdGlvbk51bV0uYW5zd2VyT3B0aW9ucztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHF1ZXN0aW9uc1txdWVzdGlvbk51bS0xXS5hbnN3ZXIgPSBhbnN3ZXI7XG5cbiAgICAgICAgICAgIHF1ZXN0aW9uTnVtKys7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZENvdW50cnkgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgIC8vY29uc29sZS5sb2coJHJvb3RTY29wZS51c2VybmFtZSk7XG4gICAgICAgIC8vJGh0dHAucG9zdCgnL2FwaS91c2VyQ291bnRyaWVzJyx7dXNlcm5hbWU6ICRyb290U2NvcGUudXNlci51c2VybmFtZX0pLlxuICAgICAgICAvLyAgICB0aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgLy8gICAgICAgICRzY29wZS51c2VyQ291bnRyaWVzID0gcmVzcG9uc2UudXNlckNvdW50cmllcztcbiAgICAgICAgLy8gICAgfSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlckNvdW50cmllcycse3VzZXJuYW1lOiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUsdXNlckNvdW50cmllczogWydmcmFuY2UnLCdnZXJtYW55Jywnc3BhaW4nXX0pLlxuICAgICAgICAgICAgdGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXJDb3VudHJpZXMgPSByZXNwb25zZS51c2VyQ291bnRyaWVzO1xuICAgICAgICAgICAgfSlcbiAgICB9XG5cbn1dKTtcblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpIHtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pO1xuXG5hcHAuZmFjdG9yeSgncXVlc3Rpb25uYWlyZScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBxdWVzdGlvbnM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogXCJXaGF0IGxhbmd1YWdlKHMpIGRvIHlvdSBzcGVhaz9cIiwgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnQWR5Z2hlJywgJ0FsYmFuaWFuJywgJ0FyYWdvbmVzZScsICdBcm1lbmlhbicsICdBcm9tYW5pYW4nLCAnQXJwaXRhbicsICdBc3R1cmlhbicsICdBdmFyJywgJ0F6ZXJiYWlqYW5pJywgJ0Jhc2hraXInLCAnQmFzcXVlJywgJ0JlbGFydXNpYW4nLCAnQm9zbmlhbicsICdCcmV0b24nLCAnQnVsZ2FyaWFuJywgJ0NhdGFsYW4nLCAnQ2hlY2hlbicsICdDaHV2YXNoJywgJ0Nvcm5pc2gnLCAnQ29yc2ljYW4nLCAnQ3JpbWVhbicsICdUYXRhcicsICdDcm9hdGlhbicsICdDemVjaCcsICdEYW5pc2gnLCAnRHV0Y2gnLCAnRW5nbGlzaCcsICdFcnp5YScsICdFc3RvbmlhbicsICdGYXJvZXNlJywgJ0Zpbm5pc2gnLCAnRnJlbmNoJywgJ0ZyaXNpYW4nLCAnR2FnYXV6JywgJ0dhbGljaWFuJywgJ0dhbGxvJywgJ0dlb3JnaWFuJywgJ0dlcm1hbicsICdHcmVlaycsICdIdW5nYXJpYW4nLCAnSWNlbGFuZGljJywgJ0luZ3JpYW4nLCAnSXJpc2gnLCAnSXRhbGlhbicsICdLYWJhcmRpYW4nLCAnS2FzaHViaWFuJywgJ0themFraCcsICdMYWRpbicsICdMYXRpbicsICdMYXR2aWFuJywgJ0xheicsICdMaXRodWFuaWFuJywgJ0x1eGVtYm91cmdpc2gnLCAnTWFjZWRvbmlhbicsICdNYWx0ZXNlJywgJ01hbngnLCAnTWFyaScsICdNaW5ncmVsaWFuJywgJ01pcmFuZGVzZScsICdNb250ZW5lZ3JpbicsICdOb3J3ZWdpYW4nLCAnT2NjaXRhbicsICdPc3NldGlhbicsICdQaWNhcmQnLCAnUG9saXNoJywgJ1BvcnR1Z3Vlc2UnLCAnUm9tYW5pJywgJ1JvbWFuaWFuJywgJ1JvbWFuc2gnLCAnUnVzc2lhbicsICdTYW1pJywgJ1NhcmRpbmlhbicsICdTY290cycsICdTY290dGlzaCcsJ0dhZWxpYycsICdTZXJiaWFuJywgJ1NpbGVzaWFuJywgJ1Nsb3ZhaycsICdTbG92ZW5lJywgJ1NvcmJpYW4nLCAnU3BhbmlzaCcsICdTdmFuJywgJ1N3ZWRpc2gnLCAnVGFiYXNhcmFuJywgJ1RhdGFyJywgJ1R1cmtpc2gnLCAnVWtyYWluaWFuJywgJ1ZlcHNpYW4nLCAnVsO1cm8nLCAnV2FsbG9vbicsICdXZWxzaCcsICdXeW15c29yeXMnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgZmllbGQgZG8geW91IHdvcmsgaW4/JyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnbGlzdCcsXG4gICAgICAgICAgICAgICAgYW5zd2VyT3B0aW9uczogWydBZ3JpY3VsdHVyZScsICdJbmR1c3RyeScsICdTZXJ2aWNlcyddXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAnV2hhdCBjbGltYXRlKHMpIHdvdWxkIHlvdSBwcmVmZXI/JyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnbGlzdCcsXG4gICAgICAgICAgICAgICAgYW5zd2VyT3B0aW9uczogWydUZW1wZXJhdGUnLCAnTWVkaXRlcnJhbmVhbicsICdUcm9waWNhbCcsICdBcmlkJywgJ0Rlc2VydCcsICdNYXJpdGltZScsICdXZXQnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgaXMgdGhlIGlkZWFsIHNpemUgZm9yIHRoZSBsYXJnZXN0IG1ldHJvcG9saXRhbiBhcmVhPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnU21hbGwgKDwxMDAsMDAwKScsICdNZWRpdW0gKDEwMCwwMDAtMSBtaWxsaW9uKScsICdMYXJnZSAoPjEgbWlsbGlvbiknXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1dvdWxkIHlvdSBsaWtlIHRoZSBwb3B1bGF0aW9uIGRpc3RyaWJ1dGlvbiB0byBiZSBtb3N0bHkgdXJiYW4/JyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnYm9vbGVhbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IHdvdWxkIHlvdXIgaWRlYWwgbWVkaWFuIGFnZSByYW5nZSBiZT8nLCB0eXBlOiAnbGlzdCcsXG4gICAgICAgICAgICAgICAgYW5zd2VyT3B0aW9uczogWycyMC0zMHlycycsICczMC00MHlycycsICc0MCt5ZWFycyddXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAnV2hhdCBjb3N0IG9mIGxpdmluZyBzaG91bGQgeW91ciBkZXN0aW5hdGlvbiBoYXZlPycsIHR5cGU6J2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnSGlnaCcsJ0F2ZXJhZ2UnLCdMb3cnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgcGVyY2VudGFnZSBvZiB0aGUgcG9wdWxhdGlvbiBzaG91bGQgYmUgaW50ZXJuZXQgdXNlcnM/JywgdHlwZTonbGlzdCcsXG4gICAgICAgICAgICAgICAgYW5zd2VyT3B0aW9uczogWyc8MjUlJywnMjUlLTUwJScsJzUwJS03NSUnLCc+NzUlJ11cbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgZGV0ZXJtaW5lUmVjb21tZW5kYXRpb25zOiBmdW5jdGlvbihxdWVzdGlvbm5haXJlQW5zd2Vycyxjb3VudHJpZXNUb1NlYXJjaCl7XG5cbiAgICAgICAgICAgIGNvdW50cmllcyA9IFtdO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRQcm9wb3J0aW9uYWxTY29yZSh1cHBlckxpbWl0LGxvd2VyTGltaXQsdmFsdWUpe1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA+PSBsb3dlckxpbWl0ICYmIHZhbHVlIDw9IHVwcGVyTGltaXQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTA7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb3dTY29yZSA9IDEgLSBNYXRoLmFicyh2YWx1ZSAtIGxvd2VyTGltaXQpL2xvd2VyTGltaXQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoaWdoU2NvcmUgPSAxIC0gTWF0aC5hYnModmFsdWUgLSBsb3dlckxpbWl0KS91cHBlckxpbWl0O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTAqKE1hdGgubWluKGxvd1Njb3JlLGhpZ2hTY29yZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY291bnRyaWVzVG9TZWFyY2guZm9yRWFjaChmdW5jdGlvbihjb3VudHJ5LGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNjb3JlID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgbGFib3JQZXJjZW50ID0gY291bnRyeS5sYWJvcltxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjJdO1xuICAgICAgICAgICAgICAgIC8vaWYgdXNlcidzIHNwZWNpZmllZCBpbmR1c3RyeSBpcyBtb3JlIHRoYW4gNzUlIG9mIHRoZSBjb3VudHJ5J3Mgd29ya2ZvcmNlLCBzZXQgc2NvcmUgdG8gMTBcbiAgICAgICAgICAgICAgICB2YXIgbGFib3JTY29yZSA9IGxhYm9yUGVyY2VudC83LjUgPiAxMCA/IDEwIDogbGFib3JQZXJjZW50LzEwO1xuXG4gICAgICAgICAgICAgICAgLy9jcmVhdGUgUmVndWxhciBFeHByZXNzaW9uIHRvIGNoZWNrIGNsaW1hdGUgc3RyaW5nIGZvciBjbGltYXRlIGFuc3dlcnNcbiAgICAgICAgICAgICAgICB2YXIgY2xpbWF0ZVN0cmluZyA9IG5ldyBSZWdFeHAocXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb24zLmpvaW4oJ3wnKSk7XG4gICAgICAgICAgICAgICAgLy9pZiBjbGltYXRlIHN0cmluZyBjb250YWlucyBvbmUgb2YgdGhlIGNsaW1hdGUgYW5zd2Vycywgc2V0IHNjb3JlIHRvIDEwXG4gICAgICAgICAgICAgICAgdmFyIGNsaW1hdGVTY29yZSA9IGNvdW50cnkuY2xpbWF0ZS5tYXRjaChjbGltYXRlU3RyaW5nKSAhPSBudWxsID8gMTA6IDA7XG5cblxuICAgICAgICAgICAgICAgIC8vaWYgKGNvdW50cnkucGVyQ2FwaXRhUFBQID4gbG93ZXJMaW1pdCAmJiBjb3VudHJ5LnBlckNhcGl0YVBQUCA8IHVwcGVyTGltaXQpe1xuICAgICAgICAgICAgICAgIC8vICAgIHBlckNhcGl0YVBQUFNjb3JlID0gMTA7XG4gICAgICAgICAgICAgICAgLy99ZWxzZXtcbiAgICAgICAgICAgICAgICAvLyAgICB2YXIgbG93UGVyQ2FwaXRhUFBQU2NvcmUgPSAxIC0gTWF0aC5hYnMoY291bnRyeS5wZXJDYXBpdGFQUFAgLSBsb3dlckxpbWl0KS9sb3dlckxpbWl0O1xuICAgICAgICAgICAgICAgIC8vICAgIHZhciBoaWdoUGVyQ2FwaXRhUFBQU2NvcmUgPSAxIC0gTWF0aC5hYnMoY291bnRyeS5wZXJDYXBpdGFQUFAgLSBsb3dlckxpbWl0KS91cHBlckxpbWl0O1xuICAgICAgICAgICAgICAgIC8vICAgIHBlckNhcGl0YVBQUFNjb3JlID0gMTAqKE1hdGgubWluKGxvd0xhcmdlc3RDaXR5UG9wU2NvcmUsaGlnaExhcmdlc3RDaXR5UG9wU2NvcmUpKTtcbiAgICAgICAgICAgICAgICAvL31cblxuICAgICAgICAgICAgICAgIHZhciB1c2VyTGFyZ2VzdENpdHlQb3AgPSBxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjQ7XG4gICAgICAgICAgICAgICAgc3dpdGNoKHVzZXJMYXJnZXN0Q2l0eVBvcCl7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ1NtYWxsICg8MTAwLDAwMCknOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMUU1O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ01lZGl1bSAoMTAwLDAwMC0xIG1pbGxpb24pJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAxRTU7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMUU2O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0xhcmdlICg+MSBtaWxsaW9uKSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMUU2O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDFFMjA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbGFyZ2VzdENpdHlQb3BTY29yZSA9IGdldFByb3BvcnRpb25hbFNjb3JlKGxvd2VyTGltaXQsdXBwZXJMaW1pdCxjb3VudHJ5Lmxhcmdlc3RDaXR5UG9wKTtcbiAgICAgICAgICAgICAgICAvL2lmIChjb3VudHJ5Lmxhcmdlc3RDaXR5UG9wID4gbG93ZXJMaW1pdCAmJiBjb3VudHJ5Lmxhcmdlc3RDaXR5UG9wIDwgdXBwZXJMaW1pdCl7XG4gICAgICAgICAgICAgICAgLy8gICAgbGFyZ2VzdENpdHlQb3BTY29yZSA9IDEwO1xuICAgICAgICAgICAgICAgIC8vfWVsc2V7XG4gICAgICAgICAgICAgICAgLy8gICAgdmFyIGxvd0xhcmdlc3RDaXR5UG9wU2NvcmUgPSAxIC0gTWF0aC5hYnMoY291bnRyeS5sYXJnZXN0Q2l0eVBvcCAtIGxvd2VyTGltaXQpL2xvd2VyTGltaXQ7XG4gICAgICAgICAgICAgICAgLy8gICAgdmFyIGhpZ2hMYXJnZXN0Q2l0eVBvcFNjb3JlID0gMSAtIE1hdGguYWJzKGNvdW50cnkubGFyZ2VzdENpdHlQb3AtdXBwZXJMaW1pdCkvdXBwZXJMaW1pdDtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vICAgIGxhcmdlc3RDaXR5UG9wU2NvcmUgPSAxMCooTWF0aC5taW4obG93TGFyZ2VzdENpdHlQb3BTY29yZSxoaWdoTGFyZ2VzdENpdHlQb3BTY29yZSkpO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgIHZhciB1c2VyVXJiYW5Qb3B1bGF0aW9uID0gcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb241O1xuICAgICAgICAgICAgICAgIHZhciB1cmJhblBvcHVsYXRpb25TY29yZTtcbiAgICAgICAgICAgICAgICBpZih1c2VyVXJiYW5Qb3B1bGF0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgdXJiYW5Qb3B1bGF0aW9uU2NvcmUgPSBjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbiA+IDUwID8gMTAgOiAxMCpjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbi81MDtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdXJiYW5Qb3B1bGF0aW9uU2NvcmUgPSBjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbiA8IDUwID8gMTAgOiAxMCo1MC9jb3VudHJ5LnVyYmFuUG9wdWxhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlck1lZGlhbkFnZSA9IHF1ZXN0aW9ubmFpcmVBbnN3ZXJzLnF1ZXN0aW9uNjtcbiAgICAgICAgICAgICAgICBzd2l0Y2godXNlck1lZGlhbkFnZSl7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzIwLTMweXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDMwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzMwLTQweXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAzMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA0MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICc0MCt5ZWFycyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gNDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMTUwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlclBlckNhcGl0YVBQUCA9IHF1ZXN0aW9ubmFpcmVBbnN3ZXJzLnF1ZXN0aW9uNztcbiAgICAgICAgICAgICAgICB2YXIgdXBwZXJMaW1pdCwgbG93ZXJMaW1pdDtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCh1c2VyUGVyQ2FwaXRhUFBQKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnSGlnaCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gNjAwMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMUUxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdBdmVyYWdlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAzMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA2MDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdMb3cnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMzAwMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGVyQ2FwaXRhUFBQU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5wZXJDYXBpdGFQUFApO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgbWVkaWFuQWdlU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5tZWRpYW5BZ2UpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJbnRlcm5ldFVzYWdlUGVyQ2FwaXRhID0gcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb244O1xuICAgICAgICAgICAgICAgIHN3aXRjaCh1c2VySW50ZXJuZXRVc2FnZVBlckNhcGl0YSl7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzwyNSUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMjU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnMjUlLTUwJSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMjU7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gNTA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnNTAlLTc1JSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gNTA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gNzU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSA3NTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAxMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJuZXRVc2FnZVNjb3JlID0gZ2V0UHJvcG9ydGlvbmFsU2NvcmUobG93ZXJMaW1pdCx1cHBlckxpbWl0LGNvdW50cnkuaW50ZXJuZXRVc2FnZVBlckNhcGl0YSk7XG5cbiAgICAgICAgICAgICAgICBzY29yZSA9IHNjb3JlICsgbGFib3JTY29yZSArIGNsaW1hdGVTY29yZSArIGxhcmdlc3RDaXR5UG9wU2NvcmUgKyB1cmJhblBvcHVsYXRpb25TY29yZSArIHBlckNhcGl0YVBQUFNjb3JlICsgbWVkaWFuQWdlU2NvcmUgKyBpbnRlcm5ldFVzYWdlU2NvcmU7XG4gICAgICAgICAgICAgICAgY291bnRyeS5zY29yZSA9IHNjb3JlO1xuICAgICAgICAgICAgICAgIGNvdW50cmllcy5wdXNoKGNvdW50cnkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvdW50cmllcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLnNjb3JlID4gYi5zY29yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLnNjb3JlIDwgYi5zY29yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoYS5jb3VudHJ5TmFtZSA+IGIuY291bnRyeU5hbWUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoYS5jb3VudHJ5TmFtZSA8IGIuY291bnRyeU5hbWUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcy5zbGljZSgwLDQpO1xuICAgICAgICB9XG4gICAgfTtcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==