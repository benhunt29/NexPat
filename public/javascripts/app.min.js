var app=angular.module("NextPat",["ngRoute","ngMaterial"]);app.config(["$httpProvider","$routeProvider","$locationProvider","$mdThemingProvider",function(e,t,n,o){n.html5Mode(!0),e.interceptors.push("authInterceptor"),o.theme("default").primaryPalette("blue-grey").accentPalette("blue").warnPalette("red").backgroundPalette("blue-grey"),t.when("/",{templateUrl:"/views/home.html",controller:"mainController"}).when("/about",{templateUrl:"/views/about.html",controller:"aboutController"}).when("/contact",{templateUrl:"/views/contact.html",controller:"contactController"}).when("/login",{templateUrl:"/views/login.html",controller:"loginController"}).when("/signUp",{templateUrl:"/views/signUp.html",controller:"loginController"}).when("/questionnaire",{templateUrl:"/views/questionnaire.html",controller:"questionnaireController as ctrl"}).when("/help",{templateUrl:"/views/help.html",controller:"helpController"}).when("/country",{templateUrl:"/views/country.html",controller:"countryController"}).otherwise({redirectTo:"/"})}]),app.controller("mainController",["$scope","$location",function(e,t){var n=[{question:"Have you been here before?",route:"login"},{question:"Would you like to sign up?",route:"signUp"},{question:"Okay, your information will not be saved."}];e.question=n[0].question;var o=0;e.showButtons=!0,e.getQuestion=function(a){var r=(n[o].question,n[o].route);a?t.path(r):(o++,e.question=n[o].question,o==n.length-1&&(e.showButtons=!1))}}]),app.controller("aboutController",["$scope",function(e){e.message="I'm a page that describes this application!"}]),app.controller("contactController",["$scope",function(e){e.message="I'm a page that tells you how to yell (by writing an all-caps email) at the developer!"}]),app.controller("signUpController",["$scope","$http",function(e,t){}]),app.controller("countryController",["countryPage","$scope","$http",function(e,t,n){t.countryName=e.name,console.log(t.nationMasterLink)}]),app.controller("loginController",["$scope","$http","authService","$location","$rootScope",function(e,t,n,o,a){e.submit=function(){t.post("api/login",e.form).then(function(e){n.saveToken(e.data),a.user=n.getUser(),o.path("/questionnaire")})},e.googleLogin=function(){}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,n,o,a){n.user=e.getUser(),n.user&&n.user.username&&o.path("/questionnaire"),t.logout=function(){a.get("/api/questionnaire/"+n.user.username),a.get("/api/logout").then(function(e){console.log(e)}),e.logout(),n.user=e.getUser(),o.path("/login")}}]),app.controller("helpController",["$scope",function(e){e.message="I'm a help page that currently doesn't help at all"}]),app.controller("questionnaireController",["countryPage","questionnaire","$rootScope","$scope","$location","$http","$log","$q",function(e,t,n,o,a,r,i,s){function u(){return o.list.map(function(e){return{value:e.toLowerCase(),display:e}})}function l(e){var t=angular.lowercase(e);return function(e){return 0===e.value.indexOf(t)}}var c=t.questions,p={},h={};o.questionNum=0,o.data={},o.querySearch=function(e){return e?o.list.filter(l(e)):o.list},o.data={},o.answers=[],o.pushAnswer=function(e){e&&(o.answers.push(e),o.data.showAnswers=!0,console.log("PUSH"))},r.get("/api/questionnaire/"+n.user.username).then(function(e){"object"==typeof e.data?r.post("/api/worldFactbook",{languageOption:!0,language:e.data.question1}).then(function(n){o.recommendations=t.determineRecommendations(e.data,n.data)}):(o.getQuestion(),o.list=u())}),o.getQuestion=function(){o.data.showAnswers=!1,console.log(o.data.showAnswers),o.questionNum==c.length?(o.question="Your list is being generated!",h.username=n.user.username,h.questionResponses=p,console.log(h),r.post("/api/questionnaire",h),r.post("/api/worldFactbook",{languageOption:!0,language:p.question1}).then(function(e){o.recommendations=t.determineRecommendations(p,e.data)}),o.type=""):(o.question=c[o.questionNum].question,o.type=c[o.questionNum].type,console.log(o.question,o.type),"list"==o.type&&(o.list=c[o.questionNum].answerOptions))},o.logAnswer=function(e){o.data.showAnswers=!1,console.log(o.data.showAnswers),o.questionNum++,e.constructor===Array&&(e=e.join(" ")),p["question"+o.questionNum]=e,o.answers=[],o.searchText="",console.log(p)},o.addCountry=function(){r.post("/api/userCountries",{username:n.user.username,userCountries:["france","germany","spain"]}).then(function(e){o.userCountries=e.userCountries})},o.setCountryPage=function(t){e.name=t}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var n=t.split(".")[1],o=n.replace("-","+").replace("_","/");return JSON.parse(e.atob(o))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),n=Math.round((new Date).getTime()/1e3)<=t.exp;return n||this.logout(),n}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},console.log(e.url),n.isAuthed()&&(e.headers.Authorization="Bearer "+n.getToken()),e},response:function(o){return t.search().access_token&&(n.saveToken(t.search().access_token),t.search("access_token",void 0),console.log(n.getUser())),401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(n){return 401===n.status?t.path("/login"):console.log(n),e.reject(n)}}}]),app.factory("questionnaire",function(){return{questions:[{question:"What language(s) do you speak?",type:"list",answerOptions:["Adyghe","Albanian","Aragonese","Armenian","Aromanian","Arpitan","Asturian","Avar","Azerbaijani","Bashkir","Basque","Belarusian","Bosnian","Breton","Bulgarian","Catalan","Chechen","Chuvash","Cornish","Corsican","Crimean","Croatian","Czech","Danish","Dutch","English","Erzya","Estonian","Faroese","Finnish","French","Frisian","Gagauz","Galician","Gallo","Georgian","German","Greek","Hungarian","Icelandic","Ingrian","Irish","Italian","Kabardian","Kashubian","Kazakh","Ladin","Latin","Latvian","Laz","Lithuanian","Luxembourgish","Macedonian","Maltese","Manx","Mari","Mingrelian","Mirandese","Montenegrin","Norwegian","Occitan","Ossetian","Picard","Polish","Portuguese","Romani","Romanian","Romansh","Russian","Sami","Sardinian","Scots","Scottish","Gaelic","Serbian","Silesian","Slovak","Slovene","Sorbian","Spanish","Svan","Swedish","Tabasaran","Tatar","Turkish","Ukrainian","Vepsian","VÃµro","Walloon","Welsh","Wymysorys"]},{question:"What field do you work in?",type:"list",answerOptions:["Agriculture","Industry","Services"]},{question:"What climate(s) would you prefer?",type:"list",answerOptions:["Temperate","Mediterranean","Tropical","Arid","Desert","Maritime","Wet"]},{question:"What is the ideal size for the largest metropolitan area?",type:"list",answerOptions:["Small (<100,000)","Medium (100,000-1 million)","Large (>1 million)"]},{question:"Would you like the population distribution to be mostly urban?",type:"boolean"},{question:"What would your ideal median age range be?",type:"list",answerOptions:["20-30yrs","30-40yrs","40+years"]},{question:"What cost of living should your destination have?",type:"list",answerOptions:["High","Average","Low"]},{question:"What percentage of the population should be internet users?",type:"list",answerOptions:["<25%","25%-50%","50%-75%",">75%"]}],determineRecommendations:function(e,t){function n(e,t,n){if(n>=e&&t>=n)return 10;var o=Math.abs(n-e)>Math.abs(n-t)?t:e,a=n>o?.5:1.5,r=20*(1-Math.min(1,Math.abs(n-a*o)/o));return r}return countries=[],t.forEach(function(t,o){var a,r,i,s=0,u=t.labor[e.question2]||0,l=u/7.5>10?10:u/10;i="array"==typeof e.question3?new RegExp(e.question3.join("|"),"i"):new RegExp(e.question3,"i");var c=null!=t.climate.match(i)?10:0,p=e.question4;switch(p){case"Small (<100,000)":r=0,a=1e5;break;case"Medium (100,000-1 million)":r=1e5,a=1e6;break;case"Large (>1 million)":r=1e6,a=1e20}var h,g=n(r,a,t.largestCityPop)||0,m=e.question5;h=m?t.urbanPopulation>50?10:10*t.urbanPopulation/50:t.urbanPopulation<50?10:500/t.urbanPopulation;var d=e.question6;switch(d){case"20-30yrs":r=0,a=30;break;case"30-40yrs":r=30,a=40;break;case"40+years":r=40,a=150}var w=n(r,a,t.medianAge),f=e.question7;switch(f){case"High":r=6e4,a=1e10;break;case"Average":r=3e4,a=6e4;break;case"Low":r=0,a=3e4}var y=n(r,a,t.perCapitaPPP),q=e.question8;switch(q){case"<25%":r=0,a=25;break;case"25%-50%":r=25,a=50;break;case"50%-75%":r=50,a=75;break;default:r=75,a=100}var v=n(r,a,t.internetUsagePerCapita);s=s+l+c+g+h+y+w+v,t.score=s,countries.push(t)}),countries.sort(function(e,t){return e.score>t.score?-1:e.score<t.score?1:e.countryName>t.countryName?1:e.countryName<t.countryName?-1:0}),countries.slice(0,4)}}}),app.factory("countryPage",function(){return{}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJpbnRlcmNlcHRvcnMiLCJwdXNoIiwidGhlbWUiLCJwcmltYXJ5UGFsZXR0ZSIsImFjY2VudFBhbGV0dGUiLCJ3YXJuUGFsZXR0ZSIsImJhY2tncm91bmRQYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkc2NvcGUiLCIkbG9jYXRpb24iLCJpbnRyb1F1ZXN0aW9ucyIsInF1ZXN0aW9uIiwicm91dGUiLCJxdWVzdGlvbk51bSIsInNob3dCdXR0b25zIiwiZ2V0UXVlc3Rpb24iLCJhbnN3ZXIiLCJwYXRoIiwibGVuZ3RoIiwibWVzc2FnZSIsIiRodHRwIiwiY291bnRyeVBhZ2UiLCJjb3VudHJ5TmFtZSIsIm5hbWUiLCJjb25zb2xlIiwibG9nIiwibmF0aW9uTWFzdGVyTGluayIsImF1dGhTZXJ2aWNlIiwiJHJvb3RTY29wZSIsInN1Ym1pdCIsInBvc3QiLCJmb3JtIiwidGhlbiIsInJlc3BvbnNlIiwic2F2ZVRva2VuIiwiZGF0YSIsInVzZXIiLCJnZXRVc2VyIiwiZ29vZ2xlTG9naW4iLCJ1c2VybmFtZSIsImxvZ291dCIsImdldCIsInF1ZXN0aW9ubmFpcmUiLCIkbG9nIiwiJHEiLCJsb2FkQWxsIiwibGlzdCIsIm1hcCIsIml0ZW0iLCJ2YWx1ZSIsInRvTG93ZXJDYXNlIiwiZGlzcGxheSIsImNyZWF0ZUZpbHRlckZvciIsInF1ZXJ5IiwibG93ZXJjYXNlUXVlcnkiLCJsb3dlcmNhc2UiLCJpbmRleE9mIiwicXVlc3Rpb25zIiwicXVlc3Rpb25SZXNwb25zZXMiLCJ1c2VyUXVlc3Rpb25uYWlyZSIsInF1ZXJ5U2VhcmNoIiwiZmlsdGVyIiwiYW5zd2VycyIsInB1c2hBbnN3ZXIiLCJzaG93QW5zd2VycyIsInVzZXJBbnN3ZXJzIiwibGFuZ3VhZ2VPcHRpb24iLCJsYW5ndWFnZSIsInF1ZXN0aW9uMSIsImNvdW50cmllc1RvU2VhcmNoIiwicmVjb21tZW5kYXRpb25zIiwiZGV0ZXJtaW5lUmVjb21tZW5kYXRpb25zIiwidHlwZSIsImFuc3dlck9wdGlvbnMiLCJsb2dBbnN3ZXIiLCJjb25zdHJ1Y3RvciIsIkFycmF5Iiwiam9pbiIsInNlYXJjaFRleHQiLCJhZGRDb3VudHJ5IiwidXNlckNvdW50cmllcyIsInNldENvdW50cnlQYWdlIiwic2VydmljZSIsIiR3aW5kb3ciLCJ0aGlzIiwicGFyc2VKd3QiLCJ0b2tlbiIsImJhc2U2NFVybCIsInNwbGl0IiwiYmFzZTY0IiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsImF0b2IiLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJmYWN0b3J5IiwicmVxdWVzdCIsImhlYWRlcnMiLCJ1cmwiLCJBdXRob3JpemF0aW9uIiwic2VhcmNoIiwiYWNjZXNzX3Rva2VuIiwidW5kZWZpbmVkIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCIsInF1ZXN0aW9ubmFpcmVBbnN3ZXJzIiwiZ2V0UHJvcG9ydGlvbmFsU2NvcmUiLCJsb3dlckxpbWl0IiwidXBwZXJMaW1pdCIsImxpbWl0IiwiYWJzIiwibXVsdGlwbGllciIsInNjb3JlIiwibWluIiwiY291bnRyaWVzIiwiZm9yRWFjaCIsImNvdW50cnkiLCJpbmRleCIsImNsaW1hdGVTdHJpbmciLCJsYWJvclBlcmNlbnQiLCJsYWJvciIsInF1ZXN0aW9uMiIsImxhYm9yU2NvcmUiLCJxdWVzdGlvbjMiLCJSZWdFeHAiLCJjbGltYXRlU2NvcmUiLCJjbGltYXRlIiwibWF0Y2giLCJ1c2VyTGFyZ2VzdENpdHlQb3AiLCJxdWVzdGlvbjQiLCJ1cmJhblBvcHVsYXRpb25TY29yZSIsImxhcmdlc3RDaXR5UG9wU2NvcmUiLCJsYXJnZXN0Q2l0eVBvcCIsInVzZXJVcmJhblBvcHVsYXRpb24iLCJxdWVzdGlvbjUiLCJ1cmJhblBvcHVsYXRpb24iLCJ1c2VyTWVkaWFuQWdlIiwicXVlc3Rpb242IiwibWVkaWFuQWdlU2NvcmUiLCJtZWRpYW5BZ2UiLCJ1c2VyUGVyQ2FwaXRhUFBQIiwicXVlc3Rpb243IiwicGVyQ2FwaXRhUFBQU2NvcmUiLCJwZXJDYXBpdGFQUFAiLCJ1c2VySW50ZXJuZXRVc2FnZVBlckNhcGl0YSIsInF1ZXN0aW9uOCIsImludGVybmV0VXNhZ2VTY29yZSIsImludGVybmV0VXNhZ2VQZXJDYXBpdGEiLCJzb3J0IiwiYSIsImIiLCJzbGljZSJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxXQUFBLFVBQUEsY0FFQUYsS0FBQUcsUUFBQSxnQkFBQSxpQkFBQSxvQkFBQSxxQkFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUVBRCxFQUFBRSxXQUFBLEdBRUFKLEVBQUFLLGFBQUFDLEtBQUEsbUJBRUFILEVBQ0FJLE1BQUEsV0FDQUMsZUFBQSxhQUNBQyxjQUFBLFFBQ0FDLFlBQUEsT0FDQUMsa0JBQUEsYUFFQVYsRUFBQVcsS0FBQSxLQUVBQyxZQUFBLG1CQUNBQyxXQUFBLG1CQUNBRixLQUFBLFVBRUFDLFlBQUEsb0JBQ0FDLFdBQUEsb0JBQ0FGLEtBQUEsWUFFQUMsWUFBQSxzQkFDQUMsV0FBQSxzQkFDQUYsS0FBQSxVQUVBQyxZQUFBLG9CQUNBQyxXQUFBLG9CQUNBRixLQUFBLFdBRUFDLFlBQUEscUJBQ0FDLFdBQUEsb0JBQ0FGLEtBQUEsa0JBRUFDLFlBQUEsNEJBQ0FDLFdBQUEsb0NBQ0FGLEtBQUEsU0FFQUMsWUFBQSxtQkFDQUMsV0FBQSxtQkFDQUYsS0FBQSxZQUVBQyxZQUFBLHNCQUNBQyxXQUFBLHNCQUNBQyxXQUNBQyxXQUFBLFNBSUFw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RCxFQUFBLEdBQ0FDLEVBQUEsRUFDQSxNQUNBLFNBQ0FELEVBQUEsR0FDQUMsRUFBQSxJQUlBLEdBQUFzQyxHQUFBeEMsRUFBQUMsRUFBQUMsRUFBQVEsRUFBQStCLHVCQUNBbkMsR0FBQUEsRUFBQVUsRUFBQUcsRUFBQU0sRUFBQUQsRUFBQVksRUFBQUosRUFBQVEsRUFDQTlCLEVBQUFKLE1BQUFBLEVBQ0FFLFVBQUFoSSxLQUFBa0ksS0FHQUYsVUFBQWtDLEtBQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBRCxHQUFBckMsTUFBQXNDLEVBQUF0QyxNQUNBLEdBRUFxQyxFQUFBckMsTUFBQXNDLEVBQUF0QyxNQUNBLEVBRUFxQyxFQUFBMUksWUFBQTJJLEVBQUEzSSxZQUNBLEVBRUEwSSxFQUFBMUksWUFBQTJJLEVBQUEzSSxZQUNBLEdBRUEsSUFHQXVHLFVBQUFxQyxNQUFBLEVBQUEsT0FLQS9LLElBQUFzSCxRQUFBLGNBQUEsV0FDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdOZXh0UGF0JywgWyduZ1JvdXRlJywnbmdNYXRlcmlhbCddKTtcblxuYXBwLmNvbmZpZyhbJyRodHRwUHJvdmlkZXInLCckcm91dGVQcm92aWRlcicsJyRsb2NhdGlvblByb3ZpZGVyJywnJG1kVGhlbWluZ1Byb3ZpZGVyJywgZnVuY3Rpb24oJGh0dHBQcm92aWRlciwkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsJG1kVGhlbWluZ1Byb3ZpZGVyKXtcblxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xuXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyXG4gICAgICAgIC50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnYmx1ZS1ncmV5JylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUnKVxuICAgICAgICAud2FyblBhbGV0dGUoJ3JlZCcpXG4gICAgICAgIC5iYWNrZ3JvdW5kUGFsZXR0ZSgnYmx1ZS1ncmV5Jyk7XG5cbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvaG9tZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL2Fib3V0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWJvdXQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWJvdXRDb250cm9sbGVyJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY29udGFjdENvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL3NpZ25VcCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NpZ25VcC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9xdWVzdGlvbm5haXJlJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcXVlc3Rpb25uYWlyZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdxdWVzdGlvbm5haXJlQ29udHJvbGxlciBhcyBjdHJsJ1xuICAgICAgICB9KS53aGVuKCcvaGVscCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2hlbHAuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnaGVscENvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9jb3VudHJ5JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY291bnRyeS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb3VudHJ5Q29udHJvbGxlcidcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgfSk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdtYWluQ29udHJvbGxlcicsIFsnJHNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCRsb2NhdGlvbil7XG5cbiAgICB2YXIgaW50cm9RdWVzdGlvbnMgPSBbe3F1ZXN0aW9uOiBcIkhhdmUgeW91IGJlZW4gaGVyZSBiZWZvcmU/XCIsIHJvdXRlOidsb2dpbid9LFxuICAgICAgICB7cXVlc3Rpb246IFwiV291bGQgeW91IGxpa2UgdG8gc2lnbiB1cD9cIiwgcm91dGU6ICdzaWduVXAnfSxcbiAgICAgICAge3F1ZXN0aW9uOiBcIk9rYXksIHlvdXIgaW5mb3JtYXRpb24gd2lsbCBub3QgYmUgc2F2ZWQuXCJ9XTtcbiAgICAkc2NvcGUucXVlc3Rpb24gPSBpbnRyb1F1ZXN0aW9uc1swXS5xdWVzdGlvbjtcbiAgICB2YXIgcXVlc3Rpb25OdW0gPSAwO1xuICAgICRzY29wZS5zaG93QnV0dG9ucyA9IHRydWU7XG4gICAgJHNjb3BlLmdldFF1ZXN0aW9uID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgIHZhciBxdWVzdGlvblRleHQgPSBpbnRyb1F1ZXN0aW9uc1txdWVzdGlvbk51bV0ucXVlc3Rpb247XG4gICAgICAgIHZhciByb3V0ZSA9IGludHJvUXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS5yb3V0ZTtcbiAgICAgICAgaWYgKGFuc3dlcikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgocm91dGUpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICBxdWVzdGlvbk51bSsrO1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXN0aW9uID0gaW50cm9RdWVzdGlvbnNbcXVlc3Rpb25OdW1dLnF1ZXN0aW9uO1xuICAgICAgICAgICAgaWYocXVlc3Rpb25OdW0gPT0gaW50cm9RdWVzdGlvbnMubGVuZ3RoLTEpe1xuICAgICAgICAgICAgICAgICRzY29wZS5zaG93QnV0dG9ucyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2Fib3V0Q29udHJvbGxlcicsIFsnJHNjb3BlJyxmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBwYWdlIHRoYXQgZGVzY3JpYmVzIHRoaXMgYXBwbGljYXRpb24hXCI7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdjb250YWN0Q29udHJvbGxlcicsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBwYWdlIHRoYXQgdGVsbHMgeW91IGhvdyB0byB5ZWxsIChieSB3cml0aW5nIGFuIGFsbC1jYXBzIGVtYWlsKSBhdCB0aGUgZGV2ZWxvcGVyIVwiO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignc2lnblVwQ29udHJvbGxlcicsWyckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwkaHR0cCl7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdjb3VudHJ5Q29udHJvbGxlcicsIFsnY291bnRyeVBhZ2UnLCckc2NvcGUnLCckaHR0cCcsIGZ1bmN0aW9uKGNvdW50cnlQYWdlLCRzY29wZSwkaHR0cCl7XG4gICAgJHNjb3BlLmNvdW50cnlOYW1lID0gY291bnRyeVBhZ2UubmFtZTtcbiAgICBjb25zb2xlLmxvZygkc2NvcGUubmF0aW9uTWFzdGVyTGluayk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkNvbnRyb2xsZXInLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCdhcGkvbG9naW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvcXVlc3Rpb25uYWlyZVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZ29vZ2xlTG9naW4gPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyRodHRwLmdldCgnL2FwaS9sb2dpbi9hdXRoL2dvb2dsZScpXG4gICAgICAgIC8vICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAvLyAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAvLyAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAvLyAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvcXVlc3Rpb25uYWlyZVwiKTtcbiAgICAgICAgLy8gICAgfSk7XG4gICAgfVxufV0pO1xuXG5hcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCckc2NvcGUnLCckcm9vdFNjb3BlJywnJGxvY2F0aW9uJywnJGh0dHAnLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCRyb290U2NvcGUsICRsb2NhdGlvbiwkaHR0cCl7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcXVlc3Rpb25uYWlyZScpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvcXVlc3Rpb25uYWlyZS8nKyRyb290U2NvcGUudXNlci51c2VybmFtZSk7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS9sb2dvdXQnKS5cbiAgICAgICAgICAgIHRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICB9XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdoZWxwQ29udHJvbGxlcicsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBoZWxwIHBhZ2UgdGhhdCBjdXJyZW50bHkgZG9lc24ndCBoZWxwIGF0IGFsbFwiO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcigncXVlc3Rpb25uYWlyZUNvbnRyb2xsZXInLFsnY291bnRyeVBhZ2UnLCdxdWVzdGlvbm5haXJlJywnJHJvb3RTY29wZScsJyRzY29wZScsJyRsb2NhdGlvbicsICckaHR0cCcsJyRsb2cnLCckcScsZnVuY3Rpb24oY291bnRyeVBhZ2UscXVlc3Rpb25uYWlyZSwkcm9vdFNjb3BlLCRzY29wZSwkbG9jYXRpb24sJGh0dHAsJGxvZywkcSl7XG5cblxuXG4gICAgdmFyIHF1ZXN0aW9ucyA9IHF1ZXN0aW9ubmFpcmUucXVlc3Rpb25zO1xuICAgIHZhciBxdWVzdGlvblJlc3BvbnNlcyA9IHt9O1xuICAgIHZhciB1c2VyUXVlc3Rpb25uYWlyZSA9IHt9O1xuICAgIHZhciByZWNvbW1lbmRhdGlvbnM7XG4gICAgJHNjb3BlLnF1ZXN0aW9uTnVtID0gMDtcbiAgICAkc2NvcGUuZGF0YSA9IHt9O1xuXG5cblxuICAgICRzY29wZS5xdWVyeVNlYXJjaCA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgIC8vY29uc29sZS5sb2cocXVlcnkpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCRzY29wZS5saXN0KTtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ID8gJHNjb3BlLmxpc3QuZmlsdGVyKCBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpICkgOiAkc2NvcGUubGlzdDtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gbG9hZEFsbCgpIHtcblxuICAgICAgICByZXR1cm4gJHNjb3BlLmxpc3QubWFwKCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogaXRlbS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGl0ZW1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBhbmd1bGFyLmxvd2VyY2FzZShxdWVyeSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihpdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gKGl0ZW0udmFsdWUuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgPT09IDApO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgICRzY29wZS5kYXRhID0ge307XG4gICAgLy8kc2NvcGUuZGF0YS5zaG93QW5zd2VycyA9IGZhbHNlO1xuXG4gICAgJHNjb3BlLmFuc3dlcnMgPSBbXTtcbiAgICAkc2NvcGUucHVzaEFuc3dlciA9IGZ1bmN0aW9uKGFuc3dlcil7XG4gICAgICAgIGlmKGFuc3dlcil7XG4gICAgICAgICAgICAkc2NvcGUuYW5zd2Vycy5wdXNoKGFuc3dlcik7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YS5zaG93QW5zd2VycyA9IHRydWU7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUFVTSCcpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICRodHRwLmdldCgnL2FwaS9xdWVzdGlvbm5haXJlLycrJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKS5cbiAgICAgICAgdGhlbihmdW5jdGlvbih1c2VyQW5zd2Vycyl7XG4gICAgICAgICAgICBpZih0eXBlb2YgdXNlckFuc3dlcnMuZGF0YSA9PSAnb2JqZWN0Jyl7XG4gICAgICAgICAgICAgICAgJGh0dHAucG9zdCgnL2FwaS93b3JsZEZhY3Rib29rJyx7bGFuZ3VhZ2VPcHRpb246dHJ1ZSxsYW5ndWFnZTp1c2VyQW5zd2Vycy5kYXRhLnF1ZXN0aW9uMX0pLlxuICAgICAgICAgICAgICAgICAgICB0aGVuKGZ1bmN0aW9uKGNvdW50cmllc1RvU2VhcmNoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWNvbW1lbmRhdGlvbnMgPSBxdWVzdGlvbm5haXJlLmRldGVybWluZVJlY29tbWVuZGF0aW9ucyh1c2VyQW5zd2Vycy5kYXRhLGNvdW50cmllc1RvU2VhcmNoLmRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmdldFF1ZXN0aW9uKCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpc3QgPSBsb2FkQWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG5cblxuICAgIC8vJHNjb3BlLnR5cGUgPSBxdWVzdGlvbnNbMF0udHlwZTtcbiAgICAvL2NvbnNvbGUubG9nKHF1ZXN0aW9uc1swXS5hbnN3ZXJPcHRpb25zKTtcbiAgICAvLyRzY29wZS5xdWVzdGlvbiA9IHF1ZXN0aW9uc1swXS5xdWVzdGlvbjtcbiAgICAvLyRzY29wZS5saXN0ID0gcXVlc3Rpb25zWzBdLmFuc3dlck9wdGlvbnM7XG4gICAgJHNjb3BlLmdldFF1ZXN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgJHNjb3BlLmRhdGEuc2hvd0Fuc3dlcnMgPSBmYWxzZTtcblxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuZGF0YS5zaG93QW5zd2Vycyk7XG4gICAgICAgIGlmKCRzY29wZS5xdWVzdGlvbk51bT09cXVlc3Rpb25zLmxlbmd0aCl7XG4gICAgICAgICAgICAvLyRzY29wZS5xdWVzdGlvbk51bSsrO1xuICAgICAgICAgICAgLy9xdWVzdGlvblJlc3BvbnNlc1tcInF1ZXN0aW9uXCIrKCRzY29wZS5xdWVzdGlvbk51bS0xKV0gPSAkc2NvcGUuZGF0YS5hbnN3ZXI7XG4gICAgICAgICAgICAkc2NvcGUucXVlc3Rpb24gPSAnWW91ciBsaXN0IGlzIGJlaW5nIGdlbmVyYXRlZCEnO1xuICAgICAgICAgICAgdXNlclF1ZXN0aW9ubmFpcmUudXNlcm5hbWUgPSAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWU7XG4gICAgICAgICAgICB1c2VyUXVlc3Rpb25uYWlyZS5xdWVzdGlvblJlc3BvbnNlcyA9IHF1ZXN0aW9uUmVzcG9uc2VzO1xuICAgICAgICAgICAgY29uc29sZS5sb2codXNlclF1ZXN0aW9ubmFpcmUpO1xuICAgICAgICAgICAgJGh0dHAucG9zdCgnL2FwaS9xdWVzdGlvbm5haXJlJyx1c2VyUXVlc3Rpb25uYWlyZSk7XG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3dvcmxkRmFjdGJvb2snLHtsYW5ndWFnZU9wdGlvbjp0cnVlLGxhbmd1YWdlOnF1ZXN0aW9uUmVzcG9uc2VzLnF1ZXN0aW9uMX0pLlxuICAgICAgICAgICAgICAgIHRoZW4oZnVuY3Rpb24oY291bnRyaWVzVG9TZWFyY2gpe1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVjb21tZW5kYXRpb25zID0gcXVlc3Rpb25uYWlyZS5kZXRlcm1pbmVSZWNvbW1lbmRhdGlvbnMocXVlc3Rpb25SZXNwb25zZXMsY291bnRyaWVzVG9TZWFyY2guZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkc2NvcGUudHlwZSA9ICcnO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICRzY29wZS5xdWVzdGlvbiA9IHF1ZXN0aW9uc1skc2NvcGUucXVlc3Rpb25OdW1dLnF1ZXN0aW9uO1xuICAgICAgICAgICAgJHNjb3BlLnR5cGUgPSBxdWVzdGlvbnNbJHNjb3BlLnF1ZXN0aW9uTnVtXS50eXBlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnF1ZXN0aW9uLCAkc2NvcGUudHlwZSk7XG4gICAgICAgICAgICBpZigkc2NvcGUudHlwZSA9PSAnbGlzdCcpe1xuICAgICAgICAgICAgICAgICRzY29wZS5saXN0ID0gcXVlc3Rpb25zWyRzY29wZS5xdWVzdGlvbk51bV0uYW5zd2VyT3B0aW9ucztcbiAgICAgICAgICAgICAgICAvLyRzY29wZS5saXN0ID0gbG9hZEFsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8kc2NvcGUucXVlc3Rpb25OdW0rKztcbiAgICAgICAgICAgIC8vJHNjb3BlLmRhdGEuc2hvd0Fuc3dlcnMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgJHNjb3BlLmxvZ0Fuc3dlciA9IGZ1bmN0aW9uKGFuc3dlcil7XG4gICAgICAgICRzY29wZS5kYXRhLnNob3dBbnN3ZXJzID0gZmFsc2U7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5kYXRhLnNob3dBbnN3ZXJzKTtcblxuICAgICAgICAkc2NvcGUucXVlc3Rpb25OdW0rKztcbiAgICAgICAgLy9hbnN3ZXIgPyBxdWVzdGlvblJlc3BvbnNlc1tcInF1ZXN0aW9uXCIrKCRzY29wZS5xdWVzdGlvbk51bSldID0gYW5zd2VyOiBxdWVzdGlvblJlc3BvbnNlc1tcInF1ZXN0aW9uXCIrKCRzY29wZS5xdWVzdGlvbk51bSldID0gJHNjb3BlLmFuc3dlcnM7XG4gICAgICAgIGlmKGFuc3dlci5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpe1xuICAgICAgICAgICAgYW5zd2VyID0gYW5zd2VyLmpvaW4oJyAnKVxuICAgICAgICB9XG4gICAgICAgIHF1ZXN0aW9uUmVzcG9uc2VzW1wicXVlc3Rpb25cIisoJHNjb3BlLnF1ZXN0aW9uTnVtKV0gPSBhbnN3ZXI7XG5cbiAgICAgICAgJHNjb3BlLmFuc3dlcnMgPSBbXTtcbiAgICAgICAgJHNjb3BlLnNlYXJjaFRleHQgPSAnJztcblxuICAgICAgICAvLyRzY29wZS4kYXBwbHkoJHNjb3BlLnNob3dBbnN3ZXJzID0gZmFsc2UpO1xuICAgICAgICBjb25zb2xlLmxvZyhxdWVzdGlvblJlc3BvbnNlcyk7XG4gICAgfTtcblxuICAgICRzY29wZS5hZGRDb3VudHJ5ID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAvL2NvbnNvbGUubG9nKCRyb290U2NvcGUudXNlcm5hbWUpO1xuICAgICAgICAvLyRodHRwLnBvc3QoJy9hcGkvdXNlckNvdW50cmllcycse3VzZXJuYW1lOiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWV9KS5cbiAgICAgICAgLy8gICAgdGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgIC8vICAgICAgICAkc2NvcGUudXNlckNvdW50cmllcyA9IHJlc3BvbnNlLnVzZXJDb3VudHJpZXM7XG4gICAgICAgIC8vICAgIH0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3VzZXJDb3VudHJpZXMnLHt1c2VybmFtZTogJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lLHVzZXJDb3VudHJpZXM6IFsnZnJhbmNlJywnZ2VybWFueScsJ3NwYWluJ119KS5cbiAgICAgICAgICAgIHRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgICRzY29wZS51c2VyQ291bnRyaWVzID0gcmVzcG9uc2UudXNlckNvdW50cmllcztcbiAgICAgICAgICAgIH0pXG4gICAgfTtcblxuICAgICRzY29wZS5zZXRDb3VudHJ5UGFnZSA9IGZ1bmN0aW9uKGNvdW50cnlOYW1lKXtcbiAgICAgICAgY291bnRyeVBhZ2UubmFtZSA9IGNvdW50cnlOYW1lO1xuICAgIH1cblxufV0pO1xuXG5hcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdykge1xuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7XG5cbmFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb25maWcudXJsKTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZigkbG9jYXRpb24uc2VhcmNoKCkuYWNjZXNzX3Rva2VuKXtcbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4oJGxvY2F0aW9uLnNlYXJjaCgpLmFjY2Vzc190b2tlbik7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnYWNjZXNzX3Rva2VuJywgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhdXRoU2VydmljZS5nZXRVc2VyKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ3F1ZXN0aW9ubmFpcmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcXVlc3Rpb25zOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246IFwiV2hhdCBsYW5ndWFnZShzKSBkbyB5b3Ugc3BlYWs/XCIsIHR5cGU6ICdsaXN0JyxcbiAgICAgICAgICAgICAgICBhbnN3ZXJPcHRpb25zOiBbJ0FkeWdoZScsICdBbGJhbmlhbicsICdBcmFnb25lc2UnLCAnQXJtZW5pYW4nLCAnQXJvbWFuaWFuJywgJ0FycGl0YW4nLCAnQXN0dXJpYW4nLCAnQXZhcicsICdBemVyYmFpamFuaScsICdCYXNoa2lyJywgJ0Jhc3F1ZScsICdCZWxhcnVzaWFuJywgJ0Jvc25pYW4nLCAnQnJldG9uJywgJ0J1bGdhcmlhbicsICdDYXRhbGFuJywgJ0NoZWNoZW4nLCAnQ2h1dmFzaCcsICdDb3JuaXNoJywgJ0NvcnNpY2FuJywgJ0NyaW1lYW4nLCAnQ3JvYXRpYW4nLCAnQ3plY2gnLCAnRGFuaXNoJywgJ0R1dGNoJywgJ0VuZ2xpc2gnLCAnRXJ6eWEnLCAnRXN0b25pYW4nLCAnRmFyb2VzZScsICdGaW5uaXNoJywgJ0ZyZW5jaCcsICdGcmlzaWFuJywgJ0dhZ2F1eicsICdHYWxpY2lhbicsICdHYWxsbycsICdHZW9yZ2lhbicsICdHZXJtYW4nLCAnR3JlZWsnLCAnSHVuZ2FyaWFuJywgJ0ljZWxhbmRpYycsICdJbmdyaWFuJywgJ0lyaXNoJywgJ0l0YWxpYW4nLCAnS2FiYXJkaWFuJywgJ0thc2h1YmlhbicsICdLYXpha2gnLCAnTGFkaW4nLCAnTGF0aW4nLCAnTGF0dmlhbicsICdMYXonLCAnTGl0aHVhbmlhbicsICdMdXhlbWJvdXJnaXNoJywgJ01hY2Vkb25pYW4nLCAnTWFsdGVzZScsICdNYW54JywgJ01hcmknLCAnTWluZ3JlbGlhbicsICdNaXJhbmRlc2UnLCAnTW9udGVuZWdyaW4nLCAnTm9yd2VnaWFuJywgJ09jY2l0YW4nLCAnT3NzZXRpYW4nLCAnUGljYXJkJywgJ1BvbGlzaCcsICdQb3J0dWd1ZXNlJywgJ1JvbWFuaScsICdSb21hbmlhbicsICdSb21hbnNoJywgJ1J1c3NpYW4nLCAnU2FtaScsICdTYXJkaW5pYW4nLCAnU2NvdHMnLCAnU2NvdHRpc2gnLCdHYWVsaWMnLCAnU2VyYmlhbicsICdTaWxlc2lhbicsICdTbG92YWsnLCAnU2xvdmVuZScsICdTb3JiaWFuJywgJ1NwYW5pc2gnLCAnU3ZhbicsICdTd2VkaXNoJywgJ1RhYmFzYXJhbicsICdUYXRhcicsICdUdXJraXNoJywgJ1VrcmFpbmlhbicsICdWZXBzaWFuJywgJ1bDtXJvJywgJ1dhbGxvb24nLCAnV2Vsc2gnLCAnV3lteXNvcnlzJ11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IGZpZWxkIGRvIHlvdSB3b3JrIGluPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnQWdyaWN1bHR1cmUnLCAnSW5kdXN0cnknLCAnU2VydmljZXMnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgY2xpbWF0ZShzKSB3b3VsZCB5b3UgcHJlZmVyPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnVGVtcGVyYXRlJywgJ01lZGl0ZXJyYW5lYW4nLCAnVHJvcGljYWwnLCAnQXJpZCcsICdEZXNlcnQnLCAnTWFyaXRpbWUnLCAnV2V0J11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IGlzIHRoZSBpZGVhbCBzaXplIGZvciB0aGUgbGFyZ2VzdCBtZXRyb3BvbGl0YW4gYXJlYT8nLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdsaXN0JyxcbiAgICAgICAgICAgICAgICBhbnN3ZXJPcHRpb25zOiBbJ1NtYWxsICg8MTAwLDAwMCknLCAnTWVkaXVtICgxMDAsMDAwLTEgbWlsbGlvbiknLCAnTGFyZ2UgKD4xIG1pbGxpb24pJ11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXb3VsZCB5b3UgbGlrZSB0aGUgcG9wdWxhdGlvbiBkaXN0cmlidXRpb24gdG8gYmUgbW9zdGx5IHVyYmFuPycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uOiAnV2hhdCB3b3VsZCB5b3VyIGlkZWFsIG1lZGlhbiBhZ2UgcmFuZ2UgYmU/JywgdHlwZTogJ2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnMjAtMzB5cnMnLCAnMzAtNDB5cnMnLCAnNDAreWVhcnMnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogJ1doYXQgY29zdCBvZiBsaXZpbmcgc2hvdWxkIHlvdXIgZGVzdGluYXRpb24gaGF2ZT8nLCB0eXBlOidsaXN0JyxcbiAgICAgICAgICAgICAgICBhbnN3ZXJPcHRpb25zOiBbJ0hpZ2gnLCdBdmVyYWdlJywnTG93J11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb246ICdXaGF0IHBlcmNlbnRhZ2Ugb2YgdGhlIHBvcHVsYXRpb24gc2hvdWxkIGJlIGludGVybmV0IHVzZXJzPycsIHR5cGU6J2xpc3QnLFxuICAgICAgICAgICAgICAgIGFuc3dlck9wdGlvbnM6IFsnPDI1JScsJzI1JS01MCUnLCc1MCUtNzUlJywnPjc1JSddXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIGRldGVybWluZVJlY29tbWVuZGF0aW9uczogZnVuY3Rpb24ocXVlc3Rpb25uYWlyZUFuc3dlcnMsY291bnRyaWVzVG9TZWFyY2gpe1xuXG4gICAgICAgICAgICBjb3VudHJpZXMgPSBbXTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UHJvcG9ydGlvbmFsU2NvcmUobG93ZXJMaW1pdCx1cHBlckxpbWl0LHZhbHVlKXtcblxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA+PSBsb3dlckxpbWl0ICYmIHZhbHVlIDw9IHVwcGVyTGltaXQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTA7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW1pdCA9IE1hdGguYWJzKHZhbHVlLWxvd2VyTGltaXQpID4gTWF0aC5hYnModmFsdWUtdXBwZXJMaW1pdCkgPyB1cHBlckxpbWl0IDogbG93ZXJMaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG11bHRpcGxpZXIgPSB2YWx1ZSA+IGxpbWl0ID8gMC41IDogMS41O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcmUgPSAyMCooMSAtIE1hdGgubWluKDEsTWF0aC5hYnModmFsdWUgLSBtdWx0aXBsaWVyKmxpbWl0KS9saW1pdCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb3VudHJpZXNUb1NlYXJjaC5mb3JFYWNoKGZ1bmN0aW9uKGNvdW50cnksaW5kZXgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2NvcmUgPSAwLCB1cHBlckxpbWl0LCBsb3dlckxpbWl0LCBjbGltYXRlU3RyaW5nO1xuICAgICAgICAgICAgICAgIHZhciBsYWJvclBlcmNlbnQgPSBjb3VudHJ5LmxhYm9yW3F1ZXN0aW9ubmFpcmVBbnN3ZXJzLnF1ZXN0aW9uMl0gfHwgMDtcbiAgICAgICAgICAgICAgICAvL2lmIHVzZXIncyBzcGVjaWZpZWQgaW5kdXN0cnkgaXMgbW9yZSB0aGFuIDc1JSBvZiB0aGUgY291bnRyeSdzIHdvcmtmb3JjZSwgc2V0IHNjb3JlIHRvIDEwXG4gICAgICAgICAgICAgICAgdmFyIGxhYm9yU2NvcmUgPSBsYWJvclBlcmNlbnQvNy41ID4gMTAgPyAxMCA6IGxhYm9yUGVyY2VudC8xMDtcbiAgICAgICAgICAgICAgICAvL2NyZWF0ZSBSZWd1bGFyIEV4cHJlc3Npb24gdG8gY2hlY2sgY2xpbWF0ZSBzdHJpbmcgZm9yIGNsaW1hdGUgYW5zd2Vyc1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb24zID09ICdhcnJheScpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpbWF0ZVN0cmluZyA9IG5ldyBSZWdFeHAocXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb24zLmpvaW4oJ3wnKSwnaScpO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBjbGltYXRlU3RyaW5nID0gbmV3IFJlZ0V4cChxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjMsJ2knKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiBjbGltYXRlIHN0cmluZyBjb250YWlucyBvbmUgb2YgdGhlIGNsaW1hdGUgYW5zd2Vycywgc2V0IHNjb3JlIHRvIDEwXG4gICAgICAgICAgICAgICAgdmFyIGNsaW1hdGVTY29yZSA9IGNvdW50cnkuY2xpbWF0ZS5tYXRjaChjbGltYXRlU3RyaW5nKSAhPSBudWxsID8gMTA6IDA7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlckxhcmdlc3RDaXR5UG9wID0gcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb240O1xuICAgICAgICAgICAgICAgIHN3aXRjaCh1c2VyTGFyZ2VzdENpdHlQb3Ape1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdTbWFsbCAoPDEwMCwwMDApJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDFFNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdNZWRpdW0gKDEwMCwwMDAtMSBtaWxsaW9uKSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMUU1O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDFFNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdMYXJnZSAoPjEgbWlsbGlvbiknOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDFFNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAxRTIwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxhcmdlc3RDaXR5UG9wU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5sYXJnZXN0Q2l0eVBvcCkgfHwgMDtcblxuICAgICAgICAgICAgICAgIHZhciB1c2VyVXJiYW5Qb3B1bGF0aW9uID0gcXVlc3Rpb25uYWlyZUFuc3dlcnMucXVlc3Rpb241O1xuICAgICAgICAgICAgICAgIHZhciB1cmJhblBvcHVsYXRpb25TY29yZTtcbiAgICAgICAgICAgICAgICBpZih1c2VyVXJiYW5Qb3B1bGF0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgdXJiYW5Qb3B1bGF0aW9uU2NvcmUgPSBjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbiA+IDUwID8gMTAgOiAxMCpjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbi81MDtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdXJiYW5Qb3B1bGF0aW9uU2NvcmUgPSBjb3VudHJ5LnVyYmFuUG9wdWxhdGlvbiA8IDUwID8gMTAgOiAxMCo1MC9jb3VudHJ5LnVyYmFuUG9wdWxhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlck1lZGlhbkFnZSA9IHF1ZXN0aW9ubmFpcmVBbnN3ZXJzLnF1ZXN0aW9uNjtcbiAgICAgICAgICAgICAgICBzd2l0Y2godXNlck1lZGlhbkFnZSl7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzIwLTMweXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDMwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJzMwLTQweXJzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAzMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA0MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICc0MCt5ZWFycyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gNDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckxpbWl0ID0gMTUwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVkaWFuQWdlU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5tZWRpYW5BZ2UpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJQZXJDYXBpdGFQUFAgPSBxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjc7XG4gICAgICAgICAgICAgICAgc3dpdGNoKHVzZXJQZXJDYXBpdGFQUFApe1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdIaWdoJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSA2MDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAxRTEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0F2ZXJhZ2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDMwMDAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDYwMDAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0xvdyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAzMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwZXJDYXBpdGFQUFBTY29yZSA9IGdldFByb3BvcnRpb25hbFNjb3JlKGxvd2VyTGltaXQsdXBwZXJMaW1pdCxjb3VudHJ5LnBlckNhcGl0YVBQUCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlckludGVybmV0VXNhZ2VQZXJDYXBpdGEgPSBxdWVzdGlvbm5haXJlQW5zd2Vycy5xdWVzdGlvbjg7XG4gICAgICAgICAgICAgICAgc3dpdGNoKHVzZXJJbnRlcm5ldFVzYWdlUGVyQ2FwaXRhKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnPDI1JSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dlckxpbWl0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSAyNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICcyNSUtNTAlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSAyNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICc1MCUtNzUlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd2VyTGltaXQgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyTGltaXQgPSA3NTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJMaW1pdCA9IDc1O1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJMaW1pdCA9IDEwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnRlcm5ldFVzYWdlU2NvcmUgPSBnZXRQcm9wb3J0aW9uYWxTY29yZShsb3dlckxpbWl0LHVwcGVyTGltaXQsY291bnRyeS5pbnRlcm5ldFVzYWdlUGVyQ2FwaXRhKTtcbiAgICAgICAgICAgICAgICBzY29yZSA9IHNjb3JlICsgbGFib3JTY29yZSArIGNsaW1hdGVTY29yZSArIGxhcmdlc3RDaXR5UG9wU2NvcmUgKyB1cmJhblBvcHVsYXRpb25TY29yZSArIHBlckNhcGl0YVBQUFNjb3JlICsgbWVkaWFuQWdlU2NvcmUgKyBpbnRlcm5ldFVzYWdlU2NvcmU7XG4gICAgICAgICAgICAgICAgY291bnRyeS5zY29yZSA9IHNjb3JlO1xuICAgICAgICAgICAgICAgIGNvdW50cmllcy5wdXNoKGNvdW50cnkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvdW50cmllcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGEuc2NvcmUgPiBiLnNjb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGEuc2NvcmUgPCBiLnNjb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihhLmNvdW50cnlOYW1lID4gYi5jb3VudHJ5TmFtZSl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihhLmNvdW50cnlOYW1lIDwgYi5jb3VudHJ5TmFtZSl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcy5zbGljZSgwLDQpO1xuICAgICAgICB9XG4gICAgfTtcbn0pO1xuXG5hcHAuZmFjdG9yeSgnY291bnRyeVBhZ2UnLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHt9O1xufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9