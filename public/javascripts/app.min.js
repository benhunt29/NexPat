var app=angular.module("NextPat",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0),e.when("/",{templateUrl:"/views/home.html",controller:"mainController"}).when("/about",{templateUrl:"/views/about.html",controller:"aboutController"}).when("/contact",{templateUrl:"/views/contact.html",controller:"contactController"}).when("/login",{templateUrl:"/views/login.html",controller:"loginController"}).when("/signUp",{templateUrl:"/views/signUp.html",controller:"loginController"}).when("/questionnaire",{templateUrl:"/views/questionnaire.html",controller:"questionnaireController"}).when("/help",{templateUrl:"/views/help.html",controller:"helpController"}).otherwise({redirectTo:"/"})}]),app.controller("mainController",["$scope","$location",function(e,t){var o=[{question:"Have you been here before?",route:"login"},{question:"Would you like to sign up?",route:"signUp"},{question:"Okay, your information will not be saved."}];e.question=o[0].question;var n=0;e.showButtons=!0,e.getQuestion=function(r){var l=(o[n].question,o[n].route);r?t.path(l):(n++,e.question=o[n].question,n==o.length-1&&(e.showButtons=!1))}}]),app.controller("aboutController",["$scope",function(e){e.message="I'm a page that describes this application!"}]),app.controller("contactController",["$scope",function(e){e.message="I'm a page that tells you how to yell (by writing an all-caps email) at the developer!"}]),app.controller("signUpController",["$scope","$http",function(e,t){}]),app.controller("loginController",["$scope","$http","authService","$location","$rootScope",function(e,t,o,n,r){e.submit=function(){t.post("api/login",e.form).then(function(e){o.saveToken(e.data),r.user=o.getUser(),n.path("/questionnaire")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location",function(e,t,o,n){o.user=e.getUser(),o.user&&o.user.username&&n.path("/questionnaire"),t.logout=function(){e.logout(),o.user=e.getUser(),n.path("/login")}}]),app.controller("helpController",["$scope",function(e){e.message="I'm a help page that currently doesn't help at all"}]),app.controller("questionnaireController",["$scope","$location",function(e,t){var o=[{question:"Are you interested in living abroad?",type:"boolean"},{question:"Do you speak any languages besides English?",type:"boolean"},{question:"What field do you work in?",type:"list",answerOptions:["Technology","Engineering","Finance","Law","Business"]}],n=1;e.type=o[0].type,e.question=o[0].question,e.getQuestion=function(t){n==o.length?(e.question="Your list is being generated!",e.type=""):(e.question=o[n].question,e.type=o[n].type,"list"==e.type&&(e.list=o[n].answerOptions),o[n-1].answer=t,n++)}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],n=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(n))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsImh0bWw1TW9kZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiJHNjb3BlIiwiJGxvY2F0aW9uIiwiaW50cm9RdWVzdGlvbnMiLCJxdWVzdGlvbiIsInJvdXRlIiwicXVlc3Rpb25OdW0iLCJzaG93QnV0dG9ucyIsImdldFF1ZXN0aW9uIiwiYW5zd2VyIiwicGF0aCIsImxlbmd0aCIsIm1lc3NhZ2UiLCIkaHR0cCIsImF1dGhTZXJ2aWNlIiwiJHJvb3RTY29wZSIsInN1Ym1pdCIsInBvc3QiLCJmb3JtIiwidGhlbiIsInJlc3BvbnNlIiwic2F2ZVRva2VuIiwiZGF0YSIsInVzZXIiLCJnZXRVc2VyIiwidXNlcm5hbWUiLCJsb2dvdXQiLCJxdWVzdGlvbnMiLCJ0eXBlIiwiYW5zd2VyT3B0aW9ucyIsImxpc3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInRoaXMiLCJwYXJzZUp3dCIsInRva2VuIiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiY29uc29sZSIsImxvZyIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJmYWN0b3J5IiwiJHEiLCJyZXF1ZXN0IiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLFdBQUEsV0FFQUYsS0FBQUcsUUFBQSxpQkFBQSxvQkFBQSxTQUFBQyxFQUFBQyxHQUVB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bnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdOZXh0UGF0JywgWyduZ1JvdXRlJ10pO1xuXG5hcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcil7XG5cbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvaG9tZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL2Fib3V0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWJvdXQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWJvdXRDb250cm9sbGVyJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY29udGFjdENvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL3NpZ25VcCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NpZ25VcC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2xsZXInXG4gICAgICAgIH0pLndoZW4oJy9xdWVzdGlvbm5haXJlJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcXVlc3Rpb25uYWlyZS5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdxdWVzdGlvbm5haXJlQ29udHJvbGxlcidcbiAgICAgICAgfSkud2hlbignL2hlbHAnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9oZWxwLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2hlbHBDb250cm9sbGVyJ1xuICAgICAgICB9KS5vdGhlcndpc2Uoe1xuICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICB9KTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ21haW5Db250cm9sbGVyJywgWyckc2NvcGUnLCckbG9jYXRpb24nLCBmdW5jdGlvbigkc2NvcGUsJGxvY2F0aW9uKXtcblxuICAgIHZhciBpbnRyb1F1ZXN0aW9ucyA9IFt7cXVlc3Rpb246IFwiSGF2ZSB5b3UgYmVlbiBoZXJlIGJlZm9yZT9cIiwgcm91dGU6J2xvZ2luJ30sXG4gICAgICAgIHtxdWVzdGlvbjogXCJXb3VsZCB5b3UgbGlrZSB0byBzaWduIHVwP1wiLCByb3V0ZTogJ3NpZ25VcCd9LFxuICAgICAgICB7cXVlc3Rpb246IFwiT2theSwgeW91ciBpbmZvcm1hdGlvbiB3aWxsIG5vdCBiZSBzYXZlZC5cIn1dO1xuICAgICRzY29wZS5xdWVzdGlvbiA9IGludHJvUXVlc3Rpb25zWzBdLnF1ZXN0aW9uO1xuICAgIHZhciBxdWVzdGlvbk51bSA9IDA7XG4gICAgJHNjb3BlLnNob3dCdXR0b25zID0gdHJ1ZTtcbiAgICAkc2NvcGUuZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgdmFyIHF1ZXN0aW9uVGV4dCA9IGludHJvUXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS5xdWVzdGlvbjtcbiAgICAgICAgdmFyIHJvdXRlID0gaW50cm9RdWVzdGlvbnNbcXVlc3Rpb25OdW1dLnJvdXRlO1xuICAgICAgICBpZiAoYW5zd2VyKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChyb3V0ZSk7XG4gICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgIHF1ZXN0aW9uTnVtKys7XG4gICAgICAgICAgICAkc2NvcGUucXVlc3Rpb24gPSBpbnRyb1F1ZXN0aW9uc1txdWVzdGlvbk51bV0ucXVlc3Rpb247XG4gICAgICAgICAgICBpZihxdWVzdGlvbk51bSA9PSBpbnRyb1F1ZXN0aW9ucy5sZW5ndGgtMSl7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dCdXR0b25zID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignYWJvdXRDb250cm9sbGVyJywgWyckc2NvcGUnLGZ1bmN0aW9uKCRzY29wZSl7XG4gICAgJHNjb3BlLm1lc3NhZ2UgPSBcIkknbSBhIHBhZ2UgdGhhdCBkZXNjcmliZXMgdGhpcyBhcHBsaWNhdGlvbiFcIjtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2NvbnRhY3RDb250cm9sbGVyJyxbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG4gICAgJHNjb3BlLm1lc3NhZ2UgPSBcIkknbSBhIHBhZ2UgdGhhdCB0ZWxscyB5b3UgaG93IHRvIHllbGwgKGJ5IHdyaXRpbmcgYW4gYWxsLWNhcHMgZW1haWwpIGF0IHRoZSBkZXZlbG9wZXIhXCI7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdzaWduVXBDb250cm9sbGVyJyxbJyRzY29wZScsJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCRodHRwKXtcblxuXG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkNvbnRyb2xsZXInLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpe1xuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAkaHR0cC5wb3N0KCdhcGkvbG9naW4nLCAkc2NvcGUuZm9ybSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvcXVlc3Rpb25uYWlyZVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsJyRzY29wZScsJyRyb290U2NvcGUnLCckbG9jYXRpb24nLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCRyb290U2NvcGUsICRsb2NhdGlvbil7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcXVlc3Rpb25uYWlyZScpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICB9XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdoZWxwQ29udHJvbGxlcicsWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpe1xuICAgICRzY29wZS5tZXNzYWdlID0gXCJJJ20gYSBoZWxwIHBhZ2UgdGhhdCBjdXJyZW50bHkgZG9lc24ndCBoZWxwIGF0IGFsbFwiO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcigncXVlc3Rpb25uYWlyZUNvbnRyb2xsZXInLFsnJHNjb3BlJywnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCRsb2NhdGlvbil7XG5cbiAgICB2YXIgcXVlc3Rpb25zID0gW3txdWVzdGlvbjogXCJBcmUgeW91IGludGVyZXN0ZWQgaW4gbGl2aW5nIGFicm9hZD9cIix0eXBlOidib29sZWFuJ30sXG4gICAgICAgIHtxdWVzdGlvbjpcIkRvIHlvdSBzcGVhayBhbnkgbGFuZ3VhZ2VzIGJlc2lkZXMgRW5nbGlzaD9cIix0eXBlOidib29sZWFuJ30sXG4gICAge3F1ZXN0aW9uOlwiV2hhdCBmaWVsZCBkbyB5b3Ugd29yayBpbj9cIix0eXBlOidsaXN0JyxhbnN3ZXJPcHRpb25zOlsnVGVjaG5vbG9neScsJ0VuZ2luZWVyaW5nJywnRmluYW5jZScsJ0xhdycsJ0J1c2luZXNzJ119XTtcbiAgICB2YXIgcXVlc3Rpb25OdW0gPSAxO1xuICAgICRzY29wZS50eXBlID0gcXVlc3Rpb25zWzBdLnR5cGU7XG4gICAgJHNjb3BlLnF1ZXN0aW9uID0gcXVlc3Rpb25zWzBdLnF1ZXN0aW9uO1xuICAgICRzY29wZS5nZXRRdWVzdGlvbiA9IGZ1bmN0aW9uKGFuc3dlcil7XG5cbiAgICAgICAgaWYocXVlc3Rpb25OdW09PXF1ZXN0aW9ucy5sZW5ndGgpe1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXN0aW9uID0gJ1lvdXIgbGlzdCBpcyBiZWluZyBnZW5lcmF0ZWQhJztcbiAgICAgICAgICAgICRzY29wZS50eXBlID0gJyc7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXN0aW9uID0gcXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS5xdWVzdGlvbjtcbiAgICAgICAgICAgICRzY29wZS50eXBlID0gcXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS50eXBlO1xuXG4gICAgICAgICAgICBpZigkc2NvcGUudHlwZSA9PSAnbGlzdCcpe1xuICAgICAgICAgICAgICAgICRzY29wZS5saXN0ID0gcXVlc3Rpb25zW3F1ZXN0aW9uTnVtXS5hbnN3ZXJPcHRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlc3Rpb25zW3F1ZXN0aW9uTnVtLTFdLmFuc3dlciA9IGFuc3dlcjtcblxuICAgICAgICAgICAgcXVlc3Rpb25OdW0rKztcbiAgICAgICAgfVxuICAgIH07XG5cbn1dKTtcblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpIHtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==